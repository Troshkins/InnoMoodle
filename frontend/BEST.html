<!DOCTYPE html>
<html data-theme="light" lang="ru">

<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Innomoodle</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">

<style>
:root {
    --primary: #4CAF50;
    --background-primary: #f7f9fc;
    --background-secondary: #ffffff;
    --background-tertiary: #f0f2f5;
    --text-primary: #1a1a1a;
    --text-secondary: #666666;
    --text-tertiary: #999999;
    --element-primary: #d9d9d9;
    --main-primary: #3D7FFF;
    --notify-danger-primary: #ff4d4f;
    --border-radius-large: 24px;
    --border-radius-medium: 16px;
    --border-radius-small: 8px;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    --shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.1);
}

[data-theme="dark"] {
    --background-primary: #121212;
    --background-secondary: #1e1e1e;
    --background-tertiary: #2a2a2a;
    --text-primary: #f0f0f0;
    --text-secondary: #b0b0b0;
    --text-tertiary: #808080;
    --element-primary: #333333;
    --main-primary: #5a9cff;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    --shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.5);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Montserrat', sans-serif;
    background-color: var(--background-primary);
    color: var(--text-primary);
    min-height: 100vh;
    margin: 0;
    padding-top: 120px;
}

.layout {
    display: flex;
    gap: 20px;
    padding: 0 20px 20px;
    align-items: stretch;
    min-height: calc(100vh - 140px);
}

.top-toolbar {
    position: fixed;
    top: 20px;
    left: 20px;
    right: 20px;
    height: 85px;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-large);
    box-shadow: var(--shadow);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 30px;
    z-index: 100;
}

.toolbar-left {
    display: flex;
    align-items: center;
    gap: 40px;
}

.toolbar-right {
    display: flex;
    align-items: center;
    gap: 20px;
}

.toolbar-logo {
    height: 35px;
}

.toolbar-title {
    font-size: 1.5rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    height: 100%;
    padding: 5px 0;
    line-height: 1;
    margin: 0;
}

.sidebar {
    width: 250px;
    flex: 0 0 250px;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-large);
    box-shadow: var(--shadow);
    padding: 20px 0;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.sidebar-header {
    padding: 0 20px 15px;
    font-size: 1.2rem;
    font-weight: 600;
    border-bottom: 1px solid var(--element-primary);
    margin-bottom: 15px;
    display: none;
}

.sidebar__nav {
    flex-grow: 1;
}

.sidebar__nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.sidebar__nav li {
    margin: 5px 0;
}

.sidebar__nav a {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    text-decoration: none;
    color: var(--text-primary);
    font-weight: 500;
    transition: all 0.2s;
    border-radius: var(--border-radius-small);
    margin: 0 10px;
    gap: 15px;
}

.sidebar__nav a:hover,
.sidebar__nav a.active {
    background-color: rgba(61, 127, 255, 0.1);
}

.back-link {
    display: none;
}

.logout-link {
    margin-top: auto;
    background-color: rgba(255, 77, 79, 0.1);
    border-radius: var(--border-radius-small);
    height: 5%;
    padding-top: 2.5%;
    padding-left: 10px;
    margin-top: auto;
    margin-left: 20px;
    margin-right: 20px;
}

.logout-link a {
    color: var(--notify-danger-primary);
}

.logout-link a:hover {
    color: rgba(255, 77, 79, 0.15) !important;
}

.nav-icon {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
}

.main-content {
    flex: 1;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-large);
    box-shadow: var(--shadow);
    padding: 30px;
    display: flex;
    flex-direction: column;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 15px;
}

.welcome-title {
    font-size: 2rem;
    font-weight: 700;
}

.btn-toggle {
    background: var(--background-tertiary);
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    padding: 10px 15px;
    cursor: pointer;
    transition: all 0.2s;
    color: var(--text-primary);
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
}

.btn-toggle:hover {
    background-color: var(--element-primary);
}

.card-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 25px;
    margin-top: 20px;
}

.card {
    background-color: var(--background-tertiary);
    border-radius: var(--border-radius-large);
    box-shadow: var(--shadow);
    overflow: hidden;
    transition: all 0.3s;
    cursor: pointer;
    padding: 25px;
    border: 1px solid var(--element-primary);
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-hover);
    border-color: var(--main-primary);
}

.card__body {
    padding: 0;
}

.card__title {
    font-weight: 700;
    margin: 0 0 15px;
    font-size: 1.2rem;
    color: var(--text-primary);
}

.card__progress {
    margin: 0;
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 15px;
}

.progress-container {
    height: 8px;
    background-color: var(--element-primary);
    border-radius: 4px;
    margin-top: 15px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background-color: var(--primary);
    border-radius: 4px;
}

.view-toggle {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
}

.view-btn {
    background: var(--background-tertiary);
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    cursor: pointer;
    padding: 10px 20px;
    transition: all 0.2s;
    color: var(--text-primary);
    font-weight: 500;
}

.view-btn.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
}

.search {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.search select,
.search input {
    background: var(--background-tertiary);
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    padding: 10px 15px;
    color: var(--text-primary);
    transition: all 0.2s;
    min-width: 150px;
}

.search input:focus {
    border-color: var(--main-primary);
    outline: none;
}

.list-view {
    display: flex !important;
    flex-direction: column;
    gap: 10px;
}

.list-view .card {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    padding: 15px 25px;
}

.list-view .card__body {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.list-view .card__title {
    margin-bottom: 0;
}

.list-view .card__progress {
    margin-bottom: 0;
    margin-right: 20px;
}

.list-view .progress-container {
    width: 150px;
    margin-top: 0;
}

@media (max-width: 992px) {
    .layout {
        flex-direction: column;
        padding: 10px;
        height: auto;
    }
    
    .top-toolbar {
        position: relative;
        top: 0;
        left: 0;
        right: 0;
        margin: 10px;
    }
    
    .sidebar {
        width: 100%;
        flex: 0 0 auto;
        margin-top: 10px;
    }
    
    .main-content {
        margin-top: 10px;
    }
}

@media (max-width: 768px) {
    .top-toolbar {
        height: auto;
        padding: 15px;
        flex-direction: column;
        gap: 15px;
    }
    
    .toolbar-left, .toolbar-right {
        width: 100%;
        justify-content: center;
    }
    
    .toolbar-right {
        flex-wrap: wrap;
    }
    
    .card-container {
        grid-template-columns: 1fr;
    }
    
    .header {
        flex-direction: column;
        gap: 15px;
        align-items: flex-start;
    }
    
    .search {
        width: 100%;
        flex-direction: column;
    }
}

.icon {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
}

h1 {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 20px;
}

h2 {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 15px;
}

.loading {
    text-align: center;
    padding: 50px;
    font-size: 1.2rem;
    color: var(--text-secondary);
}

.error {
    color: var(--notify-danger-primary);
    padding: 30px;
    text-align: center;
}

.empty-message {
    text-align: center;
    padding: 40px;
    color: var(--text-secondary);
    font-size: 1.2rem;
}

/* Редакторы */
.editor {
    background-color: var(--background-tertiary);
    border-radius: var(--border-radius-large);
    padding: 20px;
    margin-bottom: 20px;
}

.editor-title {
    font-size: 1.5rem;
    margin-bottom: 20px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

.form-input {
    width: 100%;
    padding: 10px;
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    background-color: var(--background-secondary);
    color: var(--text-primary);
}

.form-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.btn {
    padding: 10px 20px;
    border-radius: var(--border-radius-small);
    border: none;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
}

.btn-primary {
    background-color: var(--main-primary);
    color: white;
}

.btn-danger {
    background-color: var(--notify-danger-primary);
    color: white;
}

.btn-secondary {
    background-color: var(--element-primary);
    color: var(--text-primary);
}

.btn:hover {
    opacity: 0.9;
}

/* Списки */
.list-container {
    margin-top: 20px;
    max-height: 400px;
    overflow-y: auto;
}

.list-item {
    padding: 15px;
    border-bottom: 1px solid var(--element-primary);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.list-item:last-child {
    border-bottom: none;
}

.list-item-actions {
    display: flex;
    gap: 10px;
}

/* Двойные колонки */
.two-columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

/* Чекбоксы */
.checkbox-list {
    max-height: 300px;
    overflow-y: auto;
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    padding: 10px;
}

.checkbox-item {
    display: flex;
    align-items: center;
    padding: 8px 0;
}

.checkbox-item input {
    margin-right: 10px;
}

/* Вкладка профиля */
.profile-form {
    max-width: 500px;
    margin: 0 auto;
}

.role-selector {
    display: flex;
    gap: 15px;
    margin-top: 20px;
}

.role-btn {
    flex: 1;
    padding: 15px;
    border: 2px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    background: none;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
}

.role-btn.active {
    border-color: var(--main-primary);
    background-color: rgba(61, 127, 255, 0.1);
}

/* Цвет текста кнопок ролей в темной теме */
[data-theme="dark"] .role-btn {
    color: white;
}

/* Улучшение внешнего вида групп */
.groups-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.group-card {
    background: var(--background-tertiary);
    border-radius: var(--border-radius-medium);
    padding: 20px;
    border: 1px solid var(--element-primary);
    transition: all 0.2s;
}

.group-card:hover {
    border-color: var(--main-primary);
}

.group-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.group-title {
    font-weight: 600;
    font-size: 1.1rem;
}

.group-emails {
    max-height: 200px;
    overflow-y: auto;
    padding: 10px;
    background: var(--background-secondary);
    border-radius: var(--border-radius-small);
}

.group-email-item {
    padding: 8px 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.email-actions {
    display: flex;
    gap: 5px;
}

.email-actions button {
    padding: 3px 8px;
    font-size: 0.8rem;
}

/* Видимость */
.hidden {
    display: none !important;
}

/* Иконки действий */
.action-icon {
    width: 16px;
    height: 16px;
    cursor: pointer;
}

/* Поле для правильных ответов */
.correct-answers {
    margin-top: 10px;
    padding: 10px;
    background: var(--background-secondary);
    border-radius: var(--border-radius-small);
}

.correct-answer-item {
    display: flex;
    align-items: center;
    margin-bottom: 5px;
}

/* Ресурсы курса */
.resource-item {
    display: flex;
    align-items: center;
    padding: 10px;
    background: var(--background-secondary);
    border-radius: var(--border-radius-small);
    margin-bottom: 10px;
}

.resource-icon {
    width: 24px;
    height: 24px;
    margin-right: 10px;
}

/* Студенческий интерфейс теста */
.quiz-container {
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-medium);
    padding: 20px;
    background: var(--background-tertiary);
}

.quiz-info {
    display: flex;
    justify-content: space-between;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--element-primary);
}

.question {
    margin-bottom: 30px;
    padding: 15px;
    background: var(--background-secondary);
    border-radius: var(--border-radius-small);
}

.question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.question-options {
    margin-top: 10px;
}

.option {
    margin: 10px 0;
    display: flex;
    align-items: center;
}

.option input {
    margin-right: 10px;
}

.navigation-buttons {
    display: flex;
    justify-content: space-between;
    margin: 20px 0;
}

/* Course bar */
.course-bar {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    border-bottom: 1px solid var(--element-primary);
    padding-bottom: 10px;
}

.course-bar-btn {
    padding: 8px 16px;
    border-radius: var(--border-radius-small);
    background: var(--background-tertiary);
    border: 1px solid var(--element-primary);
    cursor: pointer;
    transition: all 0.2s;
}

.course-bar-btn.active {
    background-color: var(--main-primary);
    color: white;
    border-color: var(--main-primary);
}

/* Course settings */
.settings-section {
    margin-bottom: 30px;
    padding: 20px;
    background: var(--background-secondary);
    border-radius: var(--border-radius-medium);
}

.settings-group {
    margin-bottom: 15px;
}

.settings-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

/* Course themes */
.theme-card {
    background: var(--background-secondary);
    border-radius: var(--border-radius-medium);
    padding: 20px;
    margin-bottom: 15px;
    border: 1px solid var(--element-primary);
}

.theme-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

/* Deadlines */
.deadline-item {
    padding: 15px;
    margin-bottom: 10px;
    border-radius: var(--border-radius-small);
    border: 1px solid var(--element-primary);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.deadline-assignment {
    border-left: 4px solid var(--notify-danger-primary);
}

.deadline-quiz {
    border-left: 4px solid orange;
}

/* Modal */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.modal-content {
    background: var(--background-secondary);
    border-radius: var(--border-radius-large);
    padding: 30px;
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.modal-close {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--text-primary);
}

/* Rich text editor */
.rich-editor {
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    background: var(--background-secondary);
    padding: 10px;
    min-height: 200px;
}

.toolbar {
    display: flex;
    gap: 5px;
    margin-bottom: 10px;
    flex-wrap: wrap;
}

.toolbar button {
    padding: 5px 10px;
    border: 1px solid var(--element-primary);
    background: var(--background-tertiary);
    border-radius: var(--border-radius-small);
    cursor: pointer;
}

.editor-content {
    min-height: 150px;
    padding: 10px;
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
}

/* Course appearance */
.course-preview {
    display: flex;
    gap: 20px;
    margin-top: 20px;
    align-items: flex-start;
}

.course-image-preview {
    width: 200px;
    height: 120px;
    background: var(--background-tertiary);
    border: 1px dashed var(--element-primary);
    border-radius: var(--border-radius-small);
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
}

.course-image-preview img {
    max-width: 100%;
    max-height: 100%;
    border-radius: var(--border-radius-small);
}

.course-info-preview {
    flex: 1;
}

/* Performance table */
.performance-table {
    width: 100%;
    border-collapse: collapse;
}

.performance-table th,
.performance-table td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid var(--element-primary);
}

.performance-table th {
    background: var(--background-tertiary);
    font-weight: 600;
}

/* Course sidebar */
.course-sidebar {
    width: 200px;
    flex: 0 0 200px;
    background: var(--background-secondary);
    border-radius: var(--border-radius-medium);
    padding: 15px;
    margin-right: 20px;
}

.course-sidebar-item {
    padding: 10px;
    margin-bottom: 5px;
    border-radius: var(--border-radius-small);
    cursor: pointer;
}

.course-sidebar-item.active {
    background: rgba(61, 127, 255, 0.1);
}

.course-content {
    flex: 1;
}

.course-layout {
    display: flex;
    gap: 20px;
}

/* Add resources */
.resource-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

/* Assignment types */
.assignment-type {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.type-btn {
    padding: 8px 15px;
    border: 1px solid var(--element-primary);
    border-radius: var(--border-radius-small);
    background: var(--background-tertiary);
    cursor: pointer;
}

.type-btn.active {
    background: var(--main-primary);
    color: white;
    border-color: var(--main-primary);
}

/* File upload */
.file-upload {
    border: 2px dashed var(--element-primary);
    border-radius: var(--border-radius-small);
    padding: 30px;
    text-align: center;
    margin-bottom: 20px;
    cursor: pointer;
}

.file-upload:hover {
    border-color: var(--main-primary);
}

.file-list {
    margin-top: 15px;
}

.file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: var(--background-tertiary);
    border-radius: var(--border-radius-small);
    margin-bottom: 10px;
}

/* Course statistics */
.statistics-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

.chart-container {
    background: var(--background-secondary);
    border-radius: var(--border-radius-medium);
    padding: 20px;
    height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.chart-placeholder {
    text-align: center;
    color: var(--text-secondary);
}

/* Course themes */
.theme-content {
    margin-top: 15px;
    padding: 15px;
    background: var(--background-tertiary);
    border-radius: var(--border-radius-small);
}

.assignment-item {
    padding: 15px;
    margin-bottom: 15px;
    background: var(--background-secondary);
    border-radius: var(--border-radius-small);
    border: 1px solid var(--element-primary);
}

.assignment-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.assignment-meta {
    display: flex;
    gap: 10px;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

/* Deadline list */
.deadline-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.deadline-header {
    font-weight: 600;
    margin-bottom: 10px;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--element-primary);
}
</style>
</head>

<body>
<div class="top-toolbar">
    <div class="toolbar-left">
        <img alt="Logo" class="toolbar-logo" style="margin-left: 30px;" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTUxIiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDU1MSAxNjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik00My42NzU0IDBIMFY0My42NzU0SDQzLjY3NTRWMFoiIGZpbGw9IiM0MEJBMjEiLz4KPHBhdGggZD0iTTE2MC4wNzQgMEgxMTYuNDEzVjExNi4zMzlIMTAxLjg2VjBINTguMTk5MlYxNTkuOTg1SDk0LjU2ODJWMTYwSDEzOC4yNDRWMTU5Ljk4NUgxNjAuMDc0VjBaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik00My42NzU0IDU4LjE1NDhIMFYxNTkuOTg1SDQzLjY3NTRWNTguMTU0OFoiIGZpbGw9IiM0MEJBMjEiLz4KPHBhdGggZD0iTTIxNy44NiAyOC4zNTgxSDIyNi41MDFWNjUuNjk5M0gyMTcuODZWMjguMzU4MVoiIGZpbGw9IiM0MEJBMjEiLz4KPHBhdGggZD0iTTI2OS42MTEgMjguMzU4MVY2NS42OTkzSDI2Mi41MTZMMjQzLjg5OCA0My4wMjc5VjY1LjY5OTNIMjM1LjM2M1YyOC4zNTgxSDI0Mi41MTFMMjYxLjA3NSA1MS4wMjk2VjI4LjM1ODFIMjY5LjYxMVoiIGZpbGw9IiM0MEJBMjEiLz4KPHBhdGggZD0iTTMxMi42OTMgMjguMzU4MVY2NS42OTkzSDMwNS41OThMMjg2Ljk4IDQzLjAyNzlWNjUuNjk5M0gyNzguNDQ1VjI4LjM1ODFIMjg1LjU5M0wzMDQuMTU3IDUxLjAyOTZWMjguMzU4MUgzMTIuNjkzWiIgZmlsbD0iIzQwQkEyMSIvPgo8cGF0aCBkPSJNMzM5LjYxMSA2Ni4zMzk1QzMzNS43MzUgNjYuMzM5NSAzMzIuMjMyIDY1LjUwMzcgMzI5LjEwMiA2My44MzIzQzMyNi4wMDggNjIuMTYwOCAzMjMuNTcyIDU5Ljg2NyAzMjEuNzk0IDU2Ljk1MDhDMzIwLjA1MSA1My45OTkxIDMxOS4xOCA1MC42OTE3IDMxOS4xOCA0Ny4wMjg3QzMxOS4xOCA0My4zNjU3IDMyMC4wNTEgNDAuMDc2MSAzMjEuNzk0IDM3LjE2QzMyMy41NzIgMzQuMjA4MiAzMjYuMDA4IDMxLjg5NjYgMzI5LjEwMiAzMC4yMjUyQzMzMi4yMzIgMjguNTUzNyAzMzUuNzM1IDI3LjcxOCAzMzkuNjExIDI3LjcxOEMzNDMuNDg4IDI3LjcxOCAzNDYuOTczIDI4LjU1MzcgMzUwLjA2NyAzMC4yMjUyQzM1My4xNjEgMzEuODk2NiAzNTUuNTk3IDM0LjIwODIgMzU3LjM3NSAzNy4xNkMzNTkuMTUzIDQwLjA3NjEgMzYwLjA0MiA0My4zNjU3IDM2MC4wNDIgNDcuMDI4N0MzNjAuMDQyIDUwLjY5MTcgMzU5LjE1MyA1My45OTkxIDM1Ny4zNzUgNTYuOTUwOEMzNTUuNTk3IDU5Ljg2NyAzNTMuMTYxIDYyLjE2MDggMzUwLjA2NyA2My44MzIzQzM0Ni45NzMgNjUuNTAzNyAzNDMuNDg4IDY2LjMzOTUgMzM5LjYxMSA2Ni4zMzk1Wk0zMzkuNjExIDU4Ljk3NzlDMzQxLjgxNiA1OC45Nzc5IDM0My44MDggNTguNDggMzQ1LjU4NiA1Ny40ODQzQzM0Ny4zNjQgNTYuNDUyOSAzNDguNzUxIDU1LjAzMDQgMzQ5Ljc0NyA1My4yMTY3QzM1MC43NzggNTEuNDAzIDM1MS4yOTQgNDkuMzQwMyAzNTEuMjk0IDQ3LjAyODdDMzUxLjI5NCA0NC43MTcxIDM1MC43NzggNDIuNjU0NSAzNDkuNzQ3IDQwLjg0MDdDMzQ4Ljc1MSAzOS4wMjcgMzQ3LjM2NCAzNy42MjIzIDM0NS41ODYgMzYuNjI2NUMzNDMuODA4IDM1LjU5NTIgMzQxLjgxNiAzNS4wNzk1IDMzOS42MTEgMzUuMDc5NUMzMzcuNDA2IDM1LjA3OTUgMzM1LjQxNSAzNS41OTUyIDMzMy42MzcgMzYuNjI2NUMzMzEuODU4IDM3LjYyMjMgMzMwLjQ1NCAzOS4wMjcgMzI5LjQyMiA0MC44NDA3QzMyOC40MjcgNDIuNjU0NSAzMjcuOTI5IDQ0LjcxNzEgMzI3LjkyOSA0Ny4wMjg3QzMyNy45MjkgNDkuMzQwMyAzMjguNDI3IDUxLjQwMyAzMjkuNDIyIDUzLjIxNjdDMzMwLjQ1NCA1NS4wMzA0IDMzMS44NTggNTYuNDUyOSAzMzMuNjM3IDU3LjQ4NDNDMzM1LjQxNSA1OC40OCAzMzcuNDA2IDU4Ljk3NzkgMzM5LjYxMSA1OC45Nzc5WiIgZmlsbD0iIzQwQkEyMSIvPgo8cGF0aCBkPSJNMzgyLjcgMjguMzU4MUMzODYuMDA4IDI4LjM1ODEgMzg4Ljg3IDI4LjkwOTMgMzkxLjI4OSAzMC4wMTE4QzM5My43NDMgMzEuMTE0MiAzOTUuNjI3IDMyLjY3OSAzOTYuOTQzIDM0LjcwNjFDMzk4LjI1OSAzNi43MzMyIDM5OC45MTcgMzkuMTMzNyAzOTguOTE3IDQxLjkwNzZDMzk4LjkxNyA0NC42NDYgMzk4LjI1OSA0Ny4wNDY1IDM5Ni45NDMgNDkuMTA5MkMzOTUuNjI3IDUxLjEzNjIgMzkzLjc0MyA1Mi43MDEgMzkxLjI4OSA1My44MDM1QzM4OC44NyA1NC44NzA0IDM4Ni4wMDggNTUuNDAzOCAzODIuNyA1NS40MDM4SDM3NS4xNzlWNjUuNjk5M0gzNjYuNTM3VjI4LjM1ODFIMzgyLjdaTTM4Mi4yMiA0OC4zNjIzQzM4NC44MTYgNDguMzYyMyAzODYuNzkgNDcuODExMSAzODguMTQxIDQ2LjcwODZDMzg5LjQ5MyA0NS41NzA2IDM5MC4xNjggNDMuOTcwMyAzOTAuMTY4IDQxLjkwNzZDMzkwLjE2OCAzOS44MDk0IDM4OS40OTMgMzguMjA5MSAzODguMTQxIDM3LjEwNjZDMzg2Ljc5IDM1Ljk2ODYgMzg0LjgxNiAzNS4zOTk2IDM4Mi4yMiAzNS4zOTk2SDM3NS4xNzlWNDguMzYyM0gzODIuMjJaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik00MjMuNjkxIDY2LjMzOTVDNDE5LjgxNSA2Ni4zMzk1IDQxNi4zMTIgNjUuNTAzNyA0MTMuMTgyIDYzLjgzMjNDNDEwLjA4OSA2Mi4xNjA4IDQwNy42NTIgNTkuODY3IDQwNS44NzQgNTYuOTUwOEM0MDQuMTMyIDUzLjk5OTEgNDAzLjI2IDUwLjY5MTcgNDAzLjI2IDQ3LjAyODdDNDAzLjI2IDQzLjM2NTcgNDA0LjEzMiA0MC4wNzYxIDQwNS44NzQgMzcuMTZDNDA3LjY1MiAzNC4yMDgyIDQxMC4wODkgMzEuODk2NiA0MTMuMTgyIDMwLjIyNTJDNDE2LjMxMiAyOC41NTM3IDQxOS44MTUgMjcuNzE4IDQyMy42OTEgMjcuNzE4QzQyNy41NjggMjcuNzE4IDQzMS4wNTMgMjguNTUzNyA0MzQuMTQ3IDMwLjIyNTJDNDM3LjI0MSAzMS44OTY2IDQzOS42NzcgMzQuMjA4MiA0NDEuNDU1IDM3LjE2QzQ0My4yMzMgNDAuMDc2MSA0NDQuMTIyIDQzLjM2NTcgNDQ0LjEyMiA0Ny4wMjg3QzQ0NC4xMjIgNTAuNjkxNyA0NDMuMjMzIDUzLjk5OTEgNDQxLjQ1NSA1Ni45NTA4QzQzOS42NzcgNTkuODY3IDQzNy4yNDEgNjIuMTYwOCA0MzQuMTQ3IDYzLjgzMjNDNDMxLjA1MyA2NS41MDM3IDQyNy41NjggNjYuMzM5NSA0MjMuNjkxIDY2LjMzOTVaTTQyMy42OTEgNTguOTc3OUM0MjUuODk2IDU4Ljk3NzkgNDI3Ljg4OCA1OC40OCA0MjkuNjY2IDU3LjQ4NDNDNDMxLjQ0NCA1Ni40NTI5IDQzMi44MzEgNTUuMDMwNCA0MzMuODI3IDUzLjIxNjdDNDM0Ljg1OCA1MS40MDMgNDM1LjM3NCA0OS4zNDAzIDQzNS4zNzQgNDcuMDI4N0M0MzUuMzc0IDQ0LjcxNzEgNDM0Ljg1OCA0Mi42NTQ1IDQzMy44MjcgNDAuODQwN0M0MzIuODMxIDM5LjAyNyA0MzEuNDQ0IDM3LjYyMjMgNDI5LjY2NiAzNi42MjY1QzQyNy44ODggMzUuNTk1MiA0MjUuODk2IDM1LjA3OTUgNDIzLjY5MSAzNS4wNzk1QzQyMS40ODYgMzUuMDc5NSA0MTkuNDk1IDM1LjU5NTIgNDE3LjcxNyAzNi42MjY1QzQxNS45MzkgMzcuNjIyMyA0MTQuNTM0IDM5LjAyNyA0MTMuNTAzIDQwLjg0MDdDNDEyLjUwNyA0Mi42NTQ1IDQxMi4wMDkgNDQuNzE3MSA0MTIuMDA5IDQ3LjAyODdDNDEyLjAwOSA0OS4zNDAzIDQxMi41MDcgNTEuNDAzIDQxMy41MDMgNTMuMjE2N0M0MTQuNTM0IDU1LjAzMDQgNDE1LjkzOSA1Ni40NTI5IDQxNy43MTcgNTcuNDg0M0M0MTkuNDk1IDU4LjQ4IDQyMS40ODYgNTguOTc3OSA0MjMuNjkxIDU4Ljk3NzlaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik00NTAuNjE3IDI4LjM1ODFINDU5LjI1OVY1OC42NTc4SDQ3Ny45ODNWNjUuNjk5M0g0NTAuNjE3VjI4LjM1ODFaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik00ODIuODExIDI4LjM1ODFINDA5MS40NTNWNjUuNjk5M0g0ODIuODExVjI4LjM1ODFaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik01MTIuNTg0IDY2LjMzOTVDNTA5LjYzMyA2Ni4zMzk1IDUwNi43NyA2NS45NDgzIDUwMy45OTYgNjUuMTY1OUM1MDEuMjU3IDY0LjM0NzkgNDk5LjA1MyA2My4yOTg4IDQ5Ny4zODEgNjIuMDE4NUw1MDAuMzE1IDU1LjUxMDVDNTAxLjkxNSA1Ni42ODQxIDUwMy44MTggNTcuNjI2NSA1MDYuMDIzIDU4LjMzNzhDNTA4LjIyOCA1OS4wNDkgNTEwLjQzMyA1OS40MDQ3IDUxMi42MzggNTkuNDA0N0M1MTUuMDkxIDU5LjQwNDcgNTE2LjkwNSA1OS4wNDkgNTE4LjA3OSA1OC4zMzc4QzUxOS4yNTIgNTcuNTkwOSA1MTkuODM5IDU2LjYxMyA1MTkuODM5IDU1LjQwMzhDNTE5LjgzOSA1NC41MTQ3IDUxOS40ODQgNTMuNzg1NyA1MTguNzcyIDUzLjIxNjdDNTE4LjA5NyA1Mi42MTIxIDUxNy4yMDcgNTIuMTMyIDUxNi4xMDUgNTEuNzc2NEM1MTUuMDM4IDUxLjQyMDcgNTEzLjU4IDUxLjAyOTYgNTExLjczMSA1MC42MDI4QzUwOC44ODYgNDkuOTI3MSA1MDYuNTU2IDQ5LjI1MTQgNTA0Ljc0MyA0OC41NzU3QzUwMi45MjkgNDcuOSA1MDEuMzY0IDQ2LjgxNTMgNTAwLjA0OCA0NS4zMjE3QzQ5OC43NjggNDMuODI4IDQ5OC4xMjggNDEuODM2NSA0OTguMTI4IDM5LjM0NzFDNDk4LjEyOCAzNy4xNzc3IDQ5OC43MTUgMzUuMjIxOCA0OTkuODg4IDMzLjQ3OTJDNTAxLjA2MiAzMS43MDEgNTAyLjgyMiAzMC4yOTYzIDUwNS4xNjkgMjkuMjY1QzUwNy41NTIgMjguMjMzNiA1MTAuNDUxIDI3LjcxOCA1MTMuODY1IDI3LjcxOEM1MTYuMjQ3IDI3LjcxOCA1MTguNTc3IDI4LjAwMjUgNTIwLjg1MyAyOC41NzE1QzUyMy4xMjkgMjkuMTQwNSA1MjUuMTIgMjkuOTU4NCA1MjYuODI3IDMxLjAyNTNMNTI0LjE2IDM3LjU4NjdDNTEyMC43MSAzNS42MzA4IDUxNy4yNjEgMzQuNjUyOCA1MTMuODExIDM0LjY1MjhDNTEwLjM5MyAzNC42NTI4IDUwOC41OTcgMzUuMDQ0IDUwNy40MjMgMzUuODI2M0M1MDYuMjg1IDM2LjYwODcgNTA1LjcxNiAzNy42NDAxIDUwNS43MTYgMzguOTIwM0M1MDUuNzE2IDQwLjIwMDYgNTA2LjM3NCA0MS4xNjA4IDUwNy42OSA0MS44MDA5QzUwOS4wNDIgNDIuNDA1NSA1MTEuMDg2IDQzLjAxMDEgNTEzLjgyNSA0My42MTQ3QzUxNi42NyA0NC4yOTA0IDUxOC45OTkgNDQuOTY2MSA1MjAuODEzIDQ1LjY0MThDNTIyLjYyNyA0Ni4zMTc1IDUyNC4xNzQgNDcuMzg0MyA1MjUuNDU0IDQ4Ljg0MjRDNTI2Ljc3IDUwLjMwMDUgNTI3LjQyOCA1Mi4yNzQzIDUyNy40MjggNTQuNzYzN0M1MjcuNDI4IDU2Ljg5NzUgNTI2LjgyMyA1OC44NTM0IDUyNS42MTQgNjAuNjMxNkM1MjQuNDQgNjIuMzc0MiA1MjIuNjYyIDYzLjc2MTEgNTIwLjI3OSA2NC43OTI1QzUxNy44OTcgNjUuODIzOCA1MTQuOTk4IDY2LjMzOTUgNTExLjU4NCA2Ni4zMzk1WiIgZmlsbD0iIzQwQkEyMSIvPgo8cGF0aCBkPSJNMjM0LjQ1IDEzMS4zMTNDMjI5LjExNSAxMzEuMzEzIDIyNC45NTQgMTI5LjgzNyAyMjEuOTY3IDEyNi44ODVDMjE5LjAxNSAxMjMuOTM0IDIxNy41NCAxMTkuNzE5IDIxNy41NCAxMTQuMjQzVjkzLjMzMTVIMjI2LjE4MVYxMTMuOTIzQzIyNi4xODEgMTIwLjYwOCAyMjguOTU1IDEyMy45NTEgMjM0LjUwMyAxMjMuOTUxQzIzNy4yMDYgMTIzLjk1MSAyMzkuMjY5IDEyMy4xNTEgMjQwLjY5MSAxMjEuNTUxQzI0Mi4xMTQgMTE5LjkxNSAyNDIuODI1IDExNy4zNzIgMjQyLjgyNSAxMTMuOTIzVjkzLjMzMTVIMjUxLjM2VjExNC4yNDNDMjUxLjM2IDExOS43MTkgMjQ5Ljg2NiAxMjMuOTM0IDI0Ni44NzkgMTI2Ljg4NUMyNDMuOTI3IDEyOS44MzcgMjM5Ljc4NCAxMzEuMzEzIDIzNC40NSAxMzEuMzEzWiIgZmlsbD0iIzQwQkEyMSIvPgo8cGF0aCBkPSJNMjk0LjE0NyA5My4zMzE1VjEzMC42NzNIMjg3LjA1MkwyNjguNDM1IDEwOC4wMDFWMzEzMC42NzNIMjU5LjlWOTMuMzMxNUgyNjcuMDQ4TDI4NS42MTIgMTE2LjAwM1Y5My4zMzE1SDI5NC4xNDdaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik0zMDIuOTgyIDkzLjMzMTVIMzExLjYyNFYxMzAuNjczSDMwMi45ODJWOTMuMzMxNVoiIGZpbGw9IiM0MEJBMjEiLz4KPHBhdGggZD0iTTM1Ni4xNzggOTMuMzMxNUwzNDAuMDE1IDEzMC42NzNIMzMxLjQ3OUwzMTUuMzY5IDkzLjMzMTVIMzI0LjcwNUwzMzYuMDY3IDEyMC4wMDRMMzQ3LjU4OSA5My4zMzE1SDM1Ni4xNzhaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik0zODguMjA4IDEyMy43MzhWMTMwLjY3M0gzNTkuMjk2VjkzLjMzMTVIMzg3LjUxNVYxMDAuMjY2SDM2Ny44ODRWMTA4LjM3NUgzODUuMjIxVjExNS4wOTZIMzY3Ljg4NFYxMjMuNzM4SDM4OC4yMDhaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik00MTguODc2IDEzMC42NzNMNDExLjY3NSAxMjAuMjcxSDQxMS4yNDhINDAzLjcyNlYxMzAuNjczSDM5NS4wODVWOTMuMzMxNUg0MTEuMjQ4QzQxNC41NTUgOTMuMzMxNSA0MTcuNDE4IDkzLjg4MjcgNDE5LjgzNiA5NC45ODUyQzQyMi4yOSA5Ni4wODc2IDQyNC4xNzUgOTcuNjUyNCA0MjUuNDkxIDk5LjY3OTVDNDI2LjgwNyAxMDEuNzA3IDQyNy40NjUgMTA0LjEwNyA0MjcuNDY1IDEwNi44ODFDNDI3LjQ2NSAxMDkuNjU1IDQyNi43ODkgMTEyLjA1NSA0MjUuNDM4IDExNC4wODNDNDI0LjEyMiAxMTYuMDc0IDQyMi4yMzcgMTE3LjYwMyA0MTkuNzgzIDExOC42N0w0MjguMTU4IDEzMC42NzNINDE4Ljg3NlpNNDE4LjcxNiAxMDYuODgxQzQxOC43MTYgMTA0Ljc4MyA0MTguMDQgMTAzLjE4MiA0MTYuNjg5IDEwMi4wOEM0MTUuMzM4IDEwMC45NDIgNDEzLjM2NCAxMDAuMzczIDQxMC43NjggMTAwLjM3M0g0MDMuNzI2VjExMy4zODlINDEwLjc2OEM0MTMuMzY0IDExMy4zODkgNDE1LjMzOCAxMTIuODIgNDE2LjY4OSAxMTEuNjgyQzQxOC4wNCAxMTAuNTQ0IDQxOC43MTYgMTA4Ljk0NCA0MTguNzE2IDEwNi44ODFaIiBmaWxsPSIjNDBCQTIxIi8+CjxwYXRoIGQ9Ik00NDYuNTgxIDEzMS4zMTNDNDQzLjYyOSAxMzEuMzEzIDQ0MC43NjYgMTMwLjkyMiA0MzcuOTkyIDEzMC4xMzlDNDM1LjI1NCAxMjkuMzIxIDQzMy4wNDkgMTI4LjI3MiA0MzEuMzc4IDEyNi45OTJMNDM0LjMxMiAxMjAuNDg0QzQzNS45MTIgMTIxLjY1NyA0MzcuODE0IDEyMi42IDQ0MC4wMTkgMTIzLjMxMUM0NDIuMjI0IDEyNC4wMjIgNDQ0LjQyOSAxMjQuMzc4IDQ0Ni42MzQgMTI0LjM3OEM0NDkuMDg4IDEyNC4zNzggNDUwLjkwMiAxMjQuMDIyIDQ1Mi4wNzUgMTIzLjMxMUM0NTMuMjQ5IDEyMi41NjQgNDUzLjgzNiAxMjEuNTg2IDQ1My44MzYgMTIwLjM3N0M0NTMuODM2IDExOS40ODggNDUzLjQ4IDExOC43NTkgNDUyLjc2OSAxMTguMTlDNDUyLjA5MyAxMTcuNTg1IDQ1MS4yMDQgMTE3LjEwNSA0NTAuMTAyIDExNi43NUM0NDkuMDM1IDExNi4zOTQgNDQ3LjU3NyAxMTYuMDAzIDQ0NS43MjcgMTE1LjU3NkM0NDIuODgyIDExNC45IDQ0MC41NTMgMTE0LjIyNSA0MzguNzM5IDExMy41NDlDNDM2LjkyNSAxMTIuODczIDQzNS4zNjEgMTExLjc4OSA0MzQuMDQ1IDExMC4yOTVDNDMyLjc2NSAxMDguODAxIDQzMi4xMjQgMTA2LjgxIDQzMi4xMjQgMTA0LjMyQzQzMi4xMjQgMTAyLjE1MSA0MzIuNzExIDEwMC4xOTUgNDMzLjg4NSA5OC40NTI2QzQzNS4wNTggOTYuNjc0NCA0MzYuODE5IDk1LjI2OTcgNDM5LjE2NiA5NC4yMzgzQzQ0MS41NDkgOTMuMjA3IDQ0NC40NDcgOTIuNjkxNCA0NDcuODYxIDkyLjY5MTRDNDUwLjI0NCA5Mi42OTE0IDQ1Mi41NzMgOTIuOTc1OSA0NTQuODQ5IDkzLjU0NDlDNDU3LjEyNSA5NC4xMTM5IDQ1OS4xMTcgOTQuOTMxOCA0NjAuODI0IDk1Ljk5ODdMNDU4LjE1NyAxMDIuNTZDNDU0LjcwNyAxMDAuNjA0IDQ1MS4yNTcgOTkuNjI2MiA0NDcuODA4IDk5LjYyNjJDNDQ1LjM4OSA5OS42MjYyIDQ0My41OTMgMTAwLjAxNyA0NDIuNDIgMTAwLjhDNDQxLjI4MiAxMDEuNTgyIDQ0MC43MTMgMTAyLjYxMyA0NDAuNzEzIDEwMy44OTRDNDQwLjcxMyAxMDUuMTc0IDQ0MS4zNzEgMTA2LjEzNCA0NDIuNjg3IDEwNi43NzRDNDQ0LjAzOCAxMDcuMzc5IDQ0Ni4wODMgMTA3Ljk4MyA0NDguODIxIDEwOC41ODhDNDUxLjY2NiAxMDkuMjY0IDQ1My45OTYgMTA5LjkzOSA0NTUuODA5IDExMC42MTVDNDU3LjYyMyAxMTEuMjkxIDQ1OS4xNyAxMTIuMzU4IDQ2MC40NSAxMTMuODE2QzQ2MS43NjYgMTE1LjI3NCA0NjIuNDI0IDExNy4yNDggNDYyLjQyNCAxMTkuNzM3QzQ2Mi40MjQgMTIxLjg3MSA0NjEuODIgMTIzLjgyNyA0NjAuNjEgMTI1LjYwNUM0NTkuNDM3IDEyNy4zNDggNDU3LjY1OSAxMjguNzM1IDQ1NS4yNzYgMTI5Ljc2NkM0NTIuODkzIDEzMC43OTcgNDQ5Ljk5NSAxMzEuMzEzIDQ0Ni41ODEgMTMxLjMxM1oiIGZpbGw9IiM0MEJBMjEiLz4KPHBhdGggZD0iTTQ2OC4zMjkgOTMuMzMxNUg0NzYuOTcxVjEzMC42NzNINDY4LjMyOVY5My4zMzE1WiIgZmlsbD0iIzQwQkEyMSIvPgo8cGF0aCBkPSJNNDkzLjU2OCAxMDAuMzczSDQ4MS42MTlWOTMuMzMxNUg1MTQuMTU5VjEwMC4zNzNINTAyLjIxVjEzMC42NzNINDkzLjU2OFYxMDAuMzczWiIgZmlsbD0iIzQwQkEyMSIvPgo8cGF0aCBkPSJNNTM2LjA1NSAxMTcuNDQzVjEzMC42NzNINTI3LjQxM1YxMTcuMzM3TDUxMi45NTcgOTMuMzMxNUg1MjIuMTMyTDUzMi4xMDggMTA5LjkyMkw1NDIuMDgzIDkzLjMzMTVINTUwLjU2NUw1MzYuMDU1IDExNy40NDNaIiBmaWxsPSIjNDBCQTIxIi8+Cjwvc3ZnPgo="/>
        <h1 class="toolbar-title">Innomoodle</h1>
    </div>
    <div class="toolbar-right">
        <button class="btn-toggle" id="langToggle" title="Switch Language">
            <svg class="icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 22C10.6333 22 9.34167 21.7373 8.125 21.212C6.90833 20.6867 5.84567 19.97 4.937 19.062C4.029 18.154 3.31233 17.0917 2.787 15.875C2.26167 14.6583 1.99933 13.3667 2 12C2 10.6167 2.26267 9.32067 2.788 8.112C3.31333 6.90333 4.03 5.84533 4.938 4.938C5.846 4.02933 6.908 3.31267 8.124 2.788C9.34 2.26333 10.632 2.00067 12 2C13.3833 2 14.6793 2.26267 15.888 2.788C17.0967 3.31333 18.1547 4.03 19.062 4.938C19.9707 5.846 20.6873 6.90433 21.212 8.113C21.7367 9.32167 21.9993 10.6173 22 12C22 13.3667 21.7373 14.6583 21.212 15.875C20.6867 17.0917 19.97 18.1543 19.062 19.063C18.154 19.971 17.0957 20.6877 15.887 21.213C14.6783 21.7383 13.3827 22.0007 12 22ZM12 19.95C12.4333 19.35 12.8083 18.725 13.125 18.075C13.4417 17.425 13.7 16.7333 13.9 16H10.1C10.3 16.7333 10.5583 17.425 10.875 18.075C11.1917 18.725 11.5667 19.35 12 19.95ZM9.4 19.55C9.1 19 8.83734 18.429 8.612 17.837C8.38667 17.245 8.19934 16.6327 8.05 16H5.1C5.58333 16.8333 6.18767 17.5583 6.913 18.175C7.63833 18.7917 8.46733 19.25 9.4 19.55ZM14.6 19.55C15.5333 19.25 16.3627 18.7917 17.088 18.175C17.8133 17.5583 18.4173 16.8333 18.9 16H15.95C15.8 16.6333 15.6127 17.246 15.388 17.838C15.1633 18.43 14.9007 19.0007 14.6 19.55ZM4.25 14H7.65C7.6 13.6667 7.56234 13.3373 7.537 13.012C7.51167 12.6867 7.49933 12.3493 7.5 12C7.5 11.65 7.51267 11.3127 7.538 10.988C7.56333 10.6633 7.60067 10.334 7.65 10H4.25C4.16667 10.3333 4.104 10.6627 4.062 10.988C4.02 11.3133 3.99933 11.6507 4 12C4 12.35 4.021 12.6873 4.063 13.012C4.105 13.3367 4.16733 13.666 4.25 14ZM9.65 14H14.35C14.4 13.6667 14.4377 13.3373 14.463 13.012C14.4883 12.6867 14.5007 12.3493 14.5 12C14.5 11.65 14.4873 11.3127 14.462 10.988C14.4367 10.6633 14.3993 10.334 14.35 10H9.65C9.6 10.3333 9.56233 10.6627 9.537 10.988C9.51167 11.3133 9.49933 11.6507 9.5 12C9.5 12.35 9.51267 12.6873 9.538 13.012C9.56333 13.3367 9.60067 13.666 9.65 14ZM16.35 14H19.75C19.8333 13.6667 19.896 13.3373 19.938 13.012C19.98 12.6867 20.0007 12.3493 20 12C20 11.65 19.979 11.3127 19.937 10.988C19.895 10.6633 19.8327 10.334 19.75 10H16.35C16.4 10.3333 16.4377 10.6627 16.463 10.988C16.4883 11.3133 16.5007 11.6507 16.5 12C16.5 12.35 16.4873 12.6873 16.462 13.012C16.4367 13.3367 16.3993 13.666 16.35 14ZM15.95 8H18.9C18.4167 7.16667 17.8127 6.44167 17.088 5.825C16.3633 5.20833 15.534 4.75 14.6 4.45C14.9 5 15.1627 5.571 15.388 6.163C15.6133 6.755 15.8007 7.36733 15.95 8ZM10.1 8H13.9C13.7 7.26667 13.4417 6.575 13.125 5.925C12.8083 5.275 12.4333 4.65 12 4.05C11.5667 4.65 11.1917 5.275 10.875 5.925C10.5583 6.575 10.3 7.26667 10.1 8ZM5.1 8H8.05C8.2 7.36667 8.38767 6.754 8.613 6.162C8.83833 5.57 9.10067 4.99933 9.4 4.45C8.46667 4.75 7.63733 5.20833 6.912 5.825C6.18667 6.44167 5.58267 7.16667 5.1 8Z" fill="currentColor"></path>
            </svg>
        </button>
        <button class="btn-toggle" id="themeToggle" title="Switch Theme">
            <svg class="icon" fill="none" id="themeIcon" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 9C13.6569 9 15 10.3431 15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9ZM12 4.5L14.03 8.5H9.97L12 4.5ZM12 19.5L9.97 15.5H14.03L12 19.5ZM4.5 12L8.5 9.97V14.03L4.5 12ZM19.5 12L15.5 14.03V9.97L19.5 12ZM14.83 14.83L18.36 18.36L16.95 19.77L13.42 16.24L14.83 14.83ZM9.17 14.83L7.76 16.24L4.23 19.77L2.82 18.36L6.35 14.83L9.17 14.83ZM9.17 9.17L6.35 9.17L2.82 5.64L4.23 4.23L7.76 7.76L9.17 9.17ZM14.83 9.17L16.24 7.76L19.77 4.23L18.36 2.82L14.83 6.35L14.83 9.17Z" fill="currentColor"></path>
            </svg>
        </button>
        <a href="https://mail.innopolis.ru">
            <button class="btn-toggle" title="Mail">
                <svg class="icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 4H4C2.9 4 2.01 4.9 2.01 6L2 18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM19 18H5C4.45 18 4 17.55 4 17V8L10.94 12.34C11.59 12.75 12.41 12.75 13.06 12.34L20 8V17C20 17.55 19.55 18 19 18ZM12 11L4 6H20L12 11Z" fill="currentColor"></path>
                </svg>
            </button>
        </a>
    </div>
</div>

<div class="layout">
    <aside class="sidebar">
        <div class="sidebar-header" id="menu-header">Меню</div>
        <nav class="sidebar__nav">
            <ul>
                <li class="back-link" id="back-link">
                    <a data-section="dashboard" href="#">
                        <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z" fill="currentColor"></path>
                        </svg>
                        <span>Назад</span>
                    </a>
                </li>
                
                <!-- Админ -->
                <li class="admin-only"><a data-section="courses" href="#">
                    <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 3L1 9L12 15L21 10.09V17H23V9L12 3ZM5 13.11V17.5L12 21L19 17.5V13.11L12 17L5 13.11Z" fill="currentColor"></path>
                    </svg>
                    <span>Курсы</span>
                </a></li>
                
                <!-- В секции групп -->
                <li class="admin-only"><a data-section="groups" href="#">
                    <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 11H13V14H11V11H8V9H11V6H13V9H16V11ZM18 4V20C18 21.1 17.1 22 16 22H4C2.9 22 2 21.1 2 20V4C2 2.9 2.9 2 4 2H16C17.1 2 18 2.9 18 4ZM16 4H4V20H16V4Z" fill="currentColor"></path>
                    </svg>
                    <span>Группы</span>
                </a></li>
                
                <li class="admin-only"><a data-section="database" href="#">
                    <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 6H12L10 4H4C2.9 4 2.01 4.9 2.01 6L2 18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6ZM20 18H4V8H20V18Z" fill="currentColor"></path>
                    </svg>
                    <span>База Данных</span>
                </a></li>
                
                <!-- Пользователь -->
                <li class="user-only"><a data-section="user_courses" href="#">
                    <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 3L1 9L12 15L21 10.09V17H23V9L12 3ZM5 13.11V17.5L12 21L19 17.5V13.11L12 17L5 13.11Z" fill="currentColor"></path>
                    </svg>
                    <span>Курсы</span>
                </a></li>
                
                <li class="user-only"><a data-section="quizzes" href="#">
                    <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17 13H13V17H11V13H7V11H13V7H17V11ZM12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z" fill="currentColor"></path>
                    </svg>
                    <span>Тесты и задания</span>
                </a></li>
                
                <li class="user-only"><a data-section="performance" href="#">
                    <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 11V5H14V11H10V5H8V11H5V13H8V19H10V13H14V19H16V13H19V11H16Z" fill="currentColor"></path>
                    </svg>
                    <span>Успеваемость</span>
                </a></li>
                
                <!-- Общий -->
                <li><a data-section="profile" href="#">
                    <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" fill="currentColor"></path>
                    </svg>
                    <span>Профиль</span>
                </a></li>
            </ul>
        </nav>
        <div class="logout-link">
            <a href="#" id="logout-link">
                <svg class="nav-icon" fill="none" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.59L17 17L22 12L17 7ZM4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z" fill="currentColor"></path>
                </svg>
                <span>Выйти</span>
            </a>
        </div>
    </aside>
    
    <main class="main-content" id="main-content">
        <div class="loading">Загрузка...</div>
    </main>
</div>

<!-- Шаблоны для контента -->
<template id="dashboard-template">
    <div class="header">
        <div>
            <h1 class="welcome-title">Добро пожаловать!</h1>
        </div>
    </div>
</template>

<template id="courses-template">
    <div class="header">
        <div>
            <h1 class="welcome-title">Курсы</h1>
        </div>
        <div>
            <button class="btn btn-primary" id="create-course-btn">Создать курс</button>
        </div>
    </div>
    <div class="card-container">
        <!-- Сюда будут добавляться карточки курсов -->
    </div>
</template>

<template id="course-creation-template">
    <div class="header">
        <h1 class="welcome-title">Создание нового курса</h1>
    </div>
    <div class="editor">
        <form id="course-form">
            <div class="form-group">
                <label for="course-title">Название курса</label>
                <input class="form-input" id="course-title" required="" type="text"/>
            </div>
            
            <div class="form-group">
                <label>Добавить преподавателей</label>
                <div class="checkbox-list" id="teachers-list"></div>
            </div>
            
            <div class="form-group">
                <label>Добавить группы студентов</label>
                <div class="checkbox-list" id="student-groups-list"></div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" id="cancel-course" type="button">Отмена</button>
                <button class="btn btn-primary" type="submit">Сохранить курс</button>
            </div>
        </form>
    </div>
</template>

<template id="course-editing-template">
    <div class="header">
        <h1 class="welcome-title" id="course-editing-title">Редактирование курса</h1>
    </div>
    <div class="editor">
        <form id="edit-course-form">
            <div class="form-group">
                <label for="edit-course-title">Название курса</label>
                <input class="form-input" id="edit-course-title" required="" type="text"/>
            </div>
            
            <div class="form-group">
                <label>Преподаватели курса</label>
                <div class="list-container" id="teachers-container"></div>
            </div>
            
            <div class="form-group">
                <label>Группы студентов</label>
                <div class="list-container" id="student-groups-container"></div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-danger" id="delete-course" type="button">Удалить курс</button>
                <button class="btn btn-primary" type="submit">Сохранить изменения</button>
            </div>
        </form>
    </div>
</template>

<template id="groups-template">
    <div class="header">
        <div>
            <h1 class="welcome-title">Группы</h1>
        </div>
        <div>
            <button class="btn btn-primary" id="create-group-btn">Создать группу</button>
        </div>
    </div>
    <div class="groups-container" id="groups-container">
        <!-- Преподаватели (системная группа) -->
        <div class="group-card">
            <div class="group-header">
                <div class="group-title">Преподаватели</div>
                <!-- <button class="btn btn-primary edit-group" data-id="teachers">Редактировать</button> -->
            </div>
            <div class="group-emails" id="teachers-emails"></div>
        </div>
        <!-- Сюда будут добавляться созданные группы -->
    </div>
</template>

<template id="group-creation-template">
    <div class="header">
        <h1 class="welcome-title">Создание группы</h1>
    </div>
    <div class="editor">
        <form id="group-form">
            <div class="form-group">
                <label for="group-name">Название группы</label>
                <input class="form-input" id="group-name" required="" type="text"/>
            </div>
            
            <div class="form-group">
                <label for="group-emails">Поиск пользователей</label>
                <input class="form-input" id="email-search" placeholder="Введите email" type="text"/>
            </div>
            
            <div class="form-group">
                <label>Выберите почты</label>
                <div class="checkbox-list" id="group-emails-list"></div>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" id="cancel-group" type="button">Отмена</button>
                <button class="btn btn-primary" type="submit">Сохранить группу</button>
            </div>
        </form>
    </div>
</template>

<template id="group-details-template">
    <div class="header">
        <h1 class="welcome-title" id="group-title">Группа: </h1>
    </div>
    <div class="editor">
        <div class="form-group">
            <label for="add-email">Добавить почту</label>
            <div class="search">
                <input class="form-input" id="add-email" placeholder="Введите email" type="email"/>
                <button class="btn btn-primary" id="add-email-btn">Добавить</button>
            </div>
        </div>
        
        <div class="list-container" id="group-emails-container"></div>
        
        <div class="form-actions">
            <button class="btn btn-danger" id="delete-group" type="button">Удалить группу</button>
        </div>
    </div>
</template>

<template id="database-template">
    <div class="header">
        <div>
            <h1 class="welcome-title">База Данных</h1>
        </div>
        <div class="search">
            <input class="btn-toggle" placeholder="Поиск по почте" type="text"/>
            <button class="btn btn-primary" id="add-email-db">Добавить почту</button>
        </div>
    </div>
    <div class="list-container" id="database-container"></div>
</template>

<template id="email-add-template">
    <div class="header">
        <h1 class="welcome-title">Добавление почты</h1>
    </div>
    <div class="editor">
        <form id="email-form">
            <div class="form-group">
                <label for="email-address">Email адрес</label>
                <input class="form-input" id="email-address" required="" type="email"/>
            </div>
            
            <div class="form-group">
                <label for="email-role">Роль</label>
                <select class="form-input" id="email-role" required="">
                    <option value="student">Студент</option>
                    <option value="teacher">Преподаватель</option>
                </select>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-secondary" id="cancel-email" type="button">Отмена</button>
                <button class="btn btn-primary" type="submit">Сохранить</button>
            </div>
        </form>
    </div>
</template>

<template id="user_courses-template">
    <div class="header">
        <h1 class="welcome-title">Мои курсы</h1>
    </div>
    <div class="card-container" id="user-courses-container">
        <!-- Сюда будут добавляться курсы пользователя -->
    </div>
</template>

<template id="course_detail-template">
    <div class="header">
        <div class="course-bar" id="course-bar">
            <!-- Кнопки будут добавлены динамически -->
        </div>
    </div>
    
    <div class="course-layout">
        <div class="course-sidebar" id="course-sidebar">
            <!-- Навигация по курсу будет добавлена динамически -->
        </div>
        
        <div class="course-content" id="course-content">
            <!-- Контент курса будет добавлен динамически -->
        </div>
    </div>
</template>

<template id="course_settings-template">
    <div class="settings-section">
        <h2>О курсе</h2>
        <div class="form-group">
            <label>Полное название курса</label>
            <input class="form-input" type="text" id="course-full-name">
        </div>
        <div class="form-group">
            <label>Краткое название курса</label>
            <input class="form-input" type="text" id="course-short-name">
        </div>
        <div class="form-group">
            <label>Ссылка на чат курса</label>
            <input class="form-input" type="url" id="course-chat-link">
        </div>
        <div class="form-group">
            <label>Ссылка на материалы курса</label>
            <input class="form-input" type="url" id="course-materials-link">
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Описание</h2>
        <div class="rich-editor">
            <div class="toolbar">
                <button type="button" title="Жирный"><b>B</b></button>
                <button type="button" title="Курсив"><i>I</i></button>
                <button type="button" title="Подчеркнутый"><u>U</u></button>
                <!-- Другие кнопки редактора -->
            </div>
            <div class="editor-content" contenteditable="true" id="course-description"></div>
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Изображение курса</h2>
        <div class="course-preview">
            <div class="course-image-preview" id="course-image-upload">
                <span>+ Загрузить изображение</span>
            </div>
            <div class="course-info-preview">
                <h3 id="preview-course-name">Название курса</h3>
                <p id="preview-course-description">Описание курса</p>
            </div>
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Часы работы</h2>
        <div class="form-group">
            <button class="btn btn-secondary" id="add-curator">Добавить куратора курса</button>
        </div>
        <div id="curators-list"></div>
    </div>
    
    <div class="settings-section">
        <h2>Формат курса</h2>
        <div class="form-group">
            <label>Видимость курса</label>
            <select class="form-input" id="course-visibility">
                <option value="show">Показать</option>
                <option value="hide">Скрыть</option>
            </select>
        </div>
        <div class="form-group">
            <label>Разрешить скачивание содержимого курса</label>
            <select class="form-input" id="course-download">
                <option value="yes">Да</option>
                <option value="no">Нет</option>
            </select>
        </div>
        <div class="form-group">
            <label>Дата начала курса</label>
            <input class="form-input" type="datetime-local" id="course-start-date">
        </div>
        <div class="form-group">
            <label>Идентификационный номер курса</label>
            <input class="form-input" type="text" id="course-id" readonly>
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Внешний вид</h2>
        <div class="form-group">
            <label>Отображение скрытых секций</label>
            <select class="form-input" id="hidden-sections">
                <option value="invisible">Полностью невидимы</option>
                <option value="unavailable">Отображаются как недоступные</option>
            </select>
        </div>
        <div class="form-group">
            <label>Показывать журнал оценок студентам</label>
            <select class="form-input" id="show-grades">
                <option value="yes">Да</option>
                <option value="no">Нет</option>
            </select>
        </div>
        <div class="form-group">
            <label>Показывать отчеты о деятельности</label>
            <select class="form-input" id="show-reports">
                <option value="yes">Да</option>
                <option value="no">Нет</option>
            </select>
        </div>
        <div class="form-group">
            <label>Показывать даты активных элементов</label>
            <select class="form-input" id="show-dates">
                <option value="yes">Да</option>
                <option value="no">Нет</option>
            </select>
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Группы</h2>
        <div class="form-group">
            <label>Групповой режим</label>
            <select class="form-input" id="group-mode">
                <option value="visible">Видимые группы</option>
                <option value="none">Нет групп</option>
                <option value="isolated">Изолированные группы</option>
            </select>
        </div>
        <div class="form-group">
            <label>Показывать журнал оценок студентам</label>
            <select class="form-input" id="group-grades">
                <option value="yes">Да</option>
                <option value="no">Нет</option>
            </select>
        </div>
    </div>
</template>

<template id="course_content-template">
    <div class="settings-section">
        <h2>Общее</h2>
        <div class="course-preview">
            <div class="course-image-preview">
                <img id="course-main-image" src="" alt="Изображение курса">
            </div>
            <div class="course-info-preview">
                <h3 id="course-main-name">Название курса</h3>
                <p id="course-main-description">Описание курса</p>
            </div>
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Темы</h2>
        <button class="btn btn-primary" id="create-theme">Создать тему</button>
        <div id="themes-container"></div>
    </div>
</template>

<template id="theme-template">
    <div class="theme-card">
        <div class="theme-header">
            <h3 class="theme-title">Новая тема</h3>
            <button class="btn btn-danger delete-theme">Удалить</button>
        </div>
        <div class="form-group">
            <label>Название темы</label>
            <input class="form-input theme-name" type="text">
        </div>
        <div class="form-group">
            <label>Описание темы</label>
            <textarea class="form-input theme-description" rows="3"></textarea>
        </div>
        <div class="theme-content">
            <h4>Задания и темы</h4>
            <button class="btn btn-secondary add-assignment">Добавить задание/тест</button>
            <div class="assignments-container"></div>
        </div>
    </div>
</template>

<template id="assignment-item-template">
    <div class="assignment-item">
        <div class="assignment-header">
            <div class="assignment-title">Новое задание</div>
            <button class="btn btn-danger delete-assignment">Удалить</button>
        </div>
        <div class="form-group">
            <label>Тип</label>
            <div class="assignment-type">
                <button class="type-btn" data-type="assignment">Задание</button>
                <button class="type-btn" data-type="quiz">Тест</button>
            </div>
        </div>
        <div class="assignment-content">
            <!-- Контент будет добавляться динамически -->
        </div>
    </div>
</template>

<template id="quizzes-template">
    <div class="header">
        <div>
            <h1 class="welcome-title">Тесты и задания</h1>
        </div>
        <div>
            <button class="btn btn-primary" id="create-quiz-btn">Создать тест или задание</button>
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Созданные мной</h2>
        <div class="card-container" id="my-quizzes-container">
            <!-- Сюда будут добавляться созданные тесты/задания -->
        </div>
    </div>
    
    <div class="settings-section">
        <h2>Дедлайны</h2>
        <div class="deadline-list" id="deadline-container">
            <!-- Сюда будут добавляться задания с дедлайнами -->
        </div>
    </div>
</template>

<template id="quiz-creation-template">
    <div class="modal" style="display: block;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="quiz-modal-title">Создание теста/задания</h2>
                <button class="modal-close">&times;</button>
            </div>
            
            <form id="quiz-form">
                <div class="form-group">
                    <label for="quiz-title">Название</label>
                    <input class="form-input" id="quiz-title" required type="text">
                </div>
                
                <div class="form-group">
                    <label for="quiz-description">Описание (опционально)</label>
                    <textarea class="form-input" id="quiz-description" rows="3"></textarea>
                </div>
                
                <div class="two-columns">
                    <div class="form-group">
                        <label for="quiz-type">Тип</label>
                        <select class="form-input" id="quiz-type" required>
                            <option value="test">Тест</option>
                            <option value="assignment">Задание</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="quiz-course">Курс</label>
                        <select class="form-input" id="quiz-course" required></select>
                    </div>
                </div>
                
                <div class="two-columns">
                    <div class="form-group">
                        <label for="quiz-start">Дата открытия</label>
                        <input class="form-input" id="quiz-start" required type="datetime-local">
                    </div>
                    
                    <div class="form-group">
                        <label for="quiz-end">Дедлайн</label>
                        <input class="form-input" id="quiz-end" required type="datetime-local">
                    </div>
                </div>
                
                <div id="quiz-content"></div>
                
                <div class="form-actions">
                    <button class="btn btn-secondary" id="cancel-quiz" type="button">Отмена</button>
                    <button class="btn btn-primary" type="submit">Сохранить</button>
                </div>
            </form>
        </div>
    </div>
</template>

<template id="test-content-template">
    <div class="form-group">
        <h3>Вопросы</h3>
        <div id="questions-container"></div>
        <button class="btn btn-secondary" id="add-question" type="button">Добавить вопрос</button>
    </div>
</template>

<template id="assignment-content-template">
    <div class="form-group">
        <label for="assignment-files">Прикрепленные файлы</label>
        <div class="file-upload" id="file-upload-area">
            Перетащите файлы сюда или кликните для загрузки
        </div>
        <input type="file" id="assignment-files" multiple style="display: none;">
        <div class="file-list" id="file-list"></div>
    </div>
</template>

<template id="question-template">
    <div class="question-editor">
        <div class="form-group">
            <label>Вопрос</label>
            <input class="question-text form-input" placeholder="Текст вопроса" type="text">
        </div>
        
        <div class="form-group">
            <label>Тип вопроса</label>
            <select class="question-type form-input">
                <option value="choice">Множественный выбор</option>
                <option value="open">Открытый вопрос</option>
            </select>
        </div>
        
        <div class="question-options">
            <div class="form-group">
                <label>Варианты ответов</label>
                <div class="options-list"></div>
                <button class="btn btn-secondary add-option" type="button">Добавить вариант</button>
            </div>
        </div>
        
        <div class="form-group">
            <button class="btn btn-danger delete-question" type="button">Удалить вопрос</button>
        </div>
    </div>
</template>

<template id="performance-template">
    <div class="header">
        <h1 class="welcome-title">Успеваемость</h1>
    </div>
    <table class="performance-table">
        <thead>
            <tr>
                <th>Курс</th>
                <th>Отметка</th>
            </tr>
        </thead>
        <tbody id="performance-table-body">
            <!-- Данные будут добавлены динамически -->
        </tbody>
    </table>
</template>

<template id="profile-template">
    <div class="header">
        <h1 class="welcome-title">Профиль</h1>
    </div>
    <div class="profile-form">
        <div class="form-group">
            <label>Имя</label>
            <input class="form-input" type="text" id="profile-name" value="Иван Иванов">
        </div>
        
        <div class="form-group">
            <label>Email</label>
            <input class="form-input" type="email" id="profile-email" value="i.ivanov@innopolis.ru">
        </div>
        
        <h2>Сменить роль</h2>
        <div class="role-selector">
            <button class="role-btn" data-role="admin" type="button">Админ</button>
            <button class="role-btn" data-role="user" type="button">Пользователь</button>
        </div>
    </div>
</template>

<template id="student_quiz_start-template">
    <div class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="quiz-modal-title">Тест/Задание</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div id="quiz-instructions">
                <h3>Инструкции</h3>
                <p id="quiz-description-text"></p>
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" id="cancel-quiz-start">Отмена</button>
                <button class="btn btn-primary" id="start-quiz">Приступить</button>
            </div>
        </div>
    </div>
</template>

<template id="student_quiz_view-template">
    <div class="header">
        <h1 class="welcome-title" id="student-quiz-title">Тест</h1>
        <div class="quiz-info">
            <div>Осталось времени: <span id="quiz-timer">59:59</span></div>
            <div>Дедлайн: <span id="quiz-deadline">30.06.2025, 23:59</span></div>
        </div>
    </div>
    <div class="quiz-container">
        <div id="quiz-instructions">
            <h3>Инструкции</h3>
            <p>Ответьте на все вопросы. После завершения нажмите "Отправить ответы".</p>
            <p>Вы можете возвращаться к предыдущим вопросам для изменения ответов.</p>
        </div>
        <form id="quiz-form">
            <!-- Вопросы будут добавляться динамически -->
        </form>
        <div class="navigation-buttons">
            <button class="btn btn-secondary" id="prev-question" type="button">Предыдущий</button>
            <button class="btn btn-secondary" id="next-question" type="button">Следующий</button>
        </div>
        <div class="form-actions">
            <button class="btn btn-primary" id="submit-quiz" type="submit">Отправить ответы</button>
        </div>
    </div>
</template>

<script>
// Инициализация данных
const initData = () => {
    if (!localStorage.getItem('role')) {
        localStorage.setItem('role', 'admin');
    }
    
    if (!localStorage.getItem('emails')) {
        const emails = [
            { id: 1, email: 'student1@innopolis.ru', role: 'student' },
            { id: 2, email: 'student2@innopolis.ru', role: 'student' },
            { id: 3, email: 'teacher1@innopolis.ru', role: 'teacher' },
            { id: 4, email: 'teacher2@innopolis.ru', role: 'teacher' }
        ];
        localStorage.setItem('emails', JSON.stringify(emails));
    }
    
    // Гарантируем создание группы преподавателей
    let groups = JSON.parse(localStorage.getItem('groups')) || [];
    if (!groups.some(g => g.id === 'teachers')) {
        groups.push({
            id: 'teachers',
            name: 'Преподаватели',
            emails: [3, 4] // Добавляем существующих преподавателей
        });
        localStorage.setItem('groups', JSON.stringify(groups));
    }
    
    if (!localStorage.getItem('courses')) {
        localStorage.setItem('courses', JSON.stringify([]));
    }
    
    if (!localStorage.getItem('quizzes')) {
        localStorage.setItem('quizzes', JSON.stringify([]));
    }
    
    if (!localStorage.getItem('userCourses')) {
        localStorage.setItem('userCourses', JSON.stringify([]));
    }
    
    if (!localStorage.getItem('currentSection')) {
        localStorage.setItem('currentSection', 'dashboard');
    }
    
    if (!localStorage.getItem('userProfile')) {
        localStorage.setItem('userProfile', JSON.stringify({
            name: 'Иван Иванов',
            email: 'i.ivanov@innopolis.ru'
        }));
    }
};
// Получение текущей роли
const getCurrentRole = () => {
    return localStorage.getItem('role') || 'admin';
};



// Обновляем видимость элементов сайдбара и кнопок по роли (admin / user)
const updateRoleVisibility = () => {
    const role = localStorage.getItem('role') || 'admin';
    document.querySelectorAll('.admin-only').forEach(el => {
        el.style.display = role === 'admin' ? '' : 'none';
    });
    document.querySelectorAll('.user-only').forEach(el => {
        el.style.display = role === 'user' ? '' : 'none';
    });
    // В разделе Курсы у администратора показываем кнопку создания
    const createCourseBtn = document.getElementById('create-course-btn');
    if (createCourseBtn) {
        createCourseBtn.style.display = role === 'admin' ? '' : 'none';
    }
};


// Инициализация темы
const initTheme = () => {
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    
    const themeIcon = document.getElementById('themeIcon');
    if (savedTheme === 'dark') {
        themeIcon.innerHTML = '<path fill="currentColor" d="M12.8956 3.55332C12.705 3.53848 12.5145 3.5357 12.3244 3.545C12.2186 3.54997 12.1127 3.558 12.007 3.56908C7.91503 3.96808 5 7.36458 5 11.5C5 15.9208 8.57925 19.5 13 19.5C16.1354 19.5 18.7827 17.7148 20 15.1563C20.0627 15.0324 20.0311 14.8841 19.9233 14.7946C19.8154 14.705 19.6562 14.6966 19.5381 14.7747C19.0995 15.061 18.6081 15.2648 18.0916 15.375C17.5751 15.4853 17.0429 15.5002 16.5214 15.4188C16 15.3374 15.4998 15.1611 15.0462 14.8993C14.5926 14.6375 14.1943 14.2953 13.8732 13.891C13.5521 13.4866 13.3145 13.0279 13.173 12.5402C13.0315 12.0525 12.9889 11.545 13.0475 11.0443C13.1061 10.5435 13.2648 10.0593 13.5151 9.6184C13.7655 9.17748 14.1024 8.78877 14.507 8.47422C14.9116 8.15968 15.3761 7.9258 15.8748 7.786C16.3734 7.6462 16.8964 7.60344 17.4127 7.66025C17.929 7.71706 18.4283 7.87231 18.881 8.11672C19.0048 8.18504 19.1569 8.17129 19.2669 8.08259C19.3769 7.99389 19.4247 7.84715 19.3881 7.70847C18.9966 6.12034 18.0004 4.71715 16.5705 3.76408C15.1405 2.81101 13.3685 2.37142 11.6097 2.52847C10.9989 2.5896 10.3958 2.72057 9.81276 2.91878C9.68142 2.96322 9.53306 2.92888 9.439 2.8328C9.34495 2.73673 9.32351 2.59824 9.38438 2.48437C9.79788 1.69938 10.4231 1.04187 11.1932 0.581793C11.9633 0.121717 12.8497 -0.122577 13.7494 0.0462515C14.6491 0.21508 15.529 0.660079 16.2958 1.34136C17.0627 2.02264 17.689 2.91806 18.1131 3.94416C18.5371 4.97026 18.7439 6.09311 18.7141 7.22457C18.6842 8.35603 18.4187 9.45971 17.9423 10.447C17.4659 11.4343 16.7946 12.2754 15.9866 12.8995C15.1787 13.5236 14.2592 13.9124 13.3094 14.032C12.3596 14.1515 11.4103 13.9982 10.5415 13.5875C9.67266 13.1767 8.91263 12.5224 8.33441 11.6846C7.75619 10.8469 7.37996 9.85389 7.24418 8.80338C7.1084 7.75287 7.21825 6.6812 7.56208 5.68922C7.90591 4.69724 8.47186 3.81929 9.205 3.14359C9.93814 2.46789 10.812 2.01786 11.7397 1.839"/>';
    } else {
        themeIcon.innerHTML = '<path fill="currentColor" d="M12 9C13.6569 9 15 10.3431 15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9ZM12 4.5L14.03 8.5H9.97L12 4.5ZM12 19.5L9.97 15.5H14.03L12 19.5ZM4.5 12L8.5 9.97V14.03L4.5 12ZM19.5 12L15.5 14.03V9.97L19.5 12ZM14.83 14.83L18.36 18.36L16.95 19.77L13.42 16.24L14.83 14.83ZM9.17 14.83L7.76 16.24L4.23 19.77L2.82 18.36L6.35 14.83L9.17 14.83ZM9.17 9.17L6.35 9.17L2.82 5.64L4.23 4.23L7.76 7.76L9.17 9.17ZM14.83 9.17L16.24 7.76L19.77 4.23L18.36 2.82L14.83 6.35L14.83 9.17Z"/>';
    }
};

// Переключение темы
const setupThemeToggle = () => {
    document.getElementById('themeToggle').addEventListener('click', function() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        initTheme();
    });
};

// Обновление сайдбара
const updateSidebar = (section) => {
    const isDashboard = section === 'dashboard';
    document.getElementById('menu-header').style.display = isDashboard ? 'block' : 'none';
    document.getElementById('back-link').style.display = isDashboard ? 'none' : 'block';
    
    document.querySelectorAll('.sidebar__nav a').forEach(a => {
        a.classList.remove('active');
        if (a.dataset.section === section) {
            a.classList.add('active');
        }
    });
};

// Рендеринг страницы
const renderPage = (templateId) => {
    const template = document.getElementById(templateId);
    if (template) {
        document.getElementById('main-content').innerHTML = '';
        document.getElementById('main-content').appendChild(template.content.cloneNode(true));
    }
};

// Загрузка контента для раздела
const loadContent = (section) => {
    try {
        let templateId = '';
        
        switch(section) {
            case 'dashboard':
                templateId = 'dashboard-template';
                break;
            case 'courses':
                templateId = 'courses-template';
                break;
            case 'course_creation':
                templateId = 'course-creation-template';
                break;
            case 'course_editing':
                templateId = 'course-editing-template';
                break;
            case 'groups':
                templateId = 'groups-template';
                break;
            case 'group_creation':
                templateId = 'group-creation-template';
                break;
            case 'group_details':
                templateId = 'group-details-template';
                break;
            case 'database':
                templateId = 'database-template';
                break;
            case 'email_add':
                templateId = 'email-add-template';
                break;
            case 'user_courses':
                templateId = 'user_courses-template';
                break;
            case 'course_detail':
                templateId = 'course_detail-template';
                break;
            case 'course_settings':
                templateId = 'course_settings-template';
                break;
            case 'course_content':
                templateId = 'course_content-template';
                break;
            case 'quizzes':
                templateId = 'quizzes-template';
                break;
            case 'quiz_creation':
                templateId = 'quiz-creation-template';
                break;
            case 'performance':
                templateId = 'performance-template';
                break;
            case 'profile':
                templateId = 'profile-template';
                break;
            case 'student_quiz_start':
                templateId = 'student_quiz_start-template';
                break;
            case 'student_quiz_view':
                templateId = 'student_quiz_view-template';
                break;
            default:
                templateId = 'dashboard-template';
        }
        
        renderPage(templateId);
        updateSidebar(section);
        localStorage.setItem('currentSection', section);
        initPageSpecificLogic(section);
        
    } catch (error) {
        document.getElementById('main-content').innerHTML = `
            <div class="error">
                <h2>Ошибка загрузки</h2>
                <p>${error.message}</p>
            </div>
        `;
    }
};

// Инициализация логики для конкретных страниц
const initPageSpecificLogic = (section) => {
    try {
        switch(section) {
            case 'dashboard':
                // Логика для dashboard
                break;
            case 'courses':
                initCoursesPage();
                break;
            case 'course_creation':
            case 'course_editing':
                initCourseCreationPage(section);
                break;
            case 'groups':
                initGroupsPage(); // Исправленная функция
                break;
            case 'group_creation':
                initGroupCreationPage();
                break;
            case 'group_details':
                initGroupDetailsPage();
                break;
            case 'database':
                initDatabasePage();
                break;
            case 'email_add':
                initEmailAddPage();
                break;
            case 'user_courses':
                initUserCoursesPage();
                break;
            case 'course_detail':
                initCourseDetailPage();
                break;
            case 'course_settings':
                initCourseSettings();
                break;
            case 'course_content':
                initCourseContent();
                break;
            case 'quizzes':
                initQuizzesPage(); // Исправленная функция
                break;
            case 'quiz_creation':
                initQuizCreationPage();
                break;
            case 'performance':
                initPerformancePage();
                break;
            case 'profile':
                initProfilePage();
                break;
            case 'student_quiz_start':
                initStudentQuizStart();
                break;
            case 'student_quiz_view':
                initStudentQuizView();
                break;
            default:
                // Обработка по умолчанию
        }
    } catch (error) {
        console.error('Error initializing page logic:', error);
        document.getElementById('main-content').innerHTML = `
            <div class="error">
                <h2>Ошибка инициализации</h2>
                <p>${error.message}</p>
            </div>
        `;
    }
};

// Инициализация страницы курсов (админ)
const initCoursesPage = () => {
    document.getElementById('create-course-btn')?.addEventListener('click', () => {
        loadContent('course_creation');
    });
    
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    const container = document.querySelector('.card-container');
    container.innerHTML = '';
    
    courses.forEach(course => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="card__body">
                <h2 class="card__title">${course.title}</h2>
                <p class="card__progress">${course.teachers?.length || 0} преподавателей, ${course.groups?.length || 0} групп</p>
            </div>
        `;
        card.addEventListener('click', () => {
            localStorage.setItem('currentCourse', course.id);
            loadContent('course_editing');
        });
        container.appendChild(card);
    });
};

// Инициализация страницы создания/редактирования курса (заменить существующую функцию)
const initCourseCreationPage = () => {
    // Отмена создания курса
    document.getElementById('cancel-course')?.addEventListener('click', () => {
        loadContent('courses');
    });

    // Заполняем список преподавателей из системной группы "teachers"
    const teachersList = document.getElementById('teachers-list');
    teachersList.innerHTML = ''; // очистка на всякий случай
    const emails = JSON.parse(localStorage.getItem('emails')) || [];
    const groups = JSON.parse(localStorage.getItem('groups')) || [];

    let teachersGroup = groups.find(g => g.id === 'teachers');
    if (!teachersGroup) {
        teachersGroup = { id: 'teachers', name: 'Преподаватели', emails: [] };
        groups.push(teachersGroup);
        localStorage.setItem('groups', JSON.stringify(groups));
    }

    teachersGroup.emails.forEach(emailId => {
        const email = emails.find(e => e.id == emailId);
        if (email) {
            const div = document.createElement('div');
            div.className = 'checkbox-item';
            div.innerHTML = `
                <input type="checkbox" id="teacher-${email.id}" value="${email.id}">
                <label for="teacher-${email.id}">${email.email}</label>
            `;
            teachersList.appendChild(div);
        }
    });

    // Заполняем список групп студентов (все кроме системы "teachers")
    const groupsList = document.getElementById('student-groups-list');
    groupsList.innerHTML = '';
    groups
      .filter(g => g.id !== 'teachers')
      .forEach(group => {
        const div = document.createElement('div');
        div.className = 'checkbox-item';
        div.innerHTML = `
            <input type="checkbox" id="group-${group.id}" value="${group.id}">
            <label for="group-${group.id}">${group.name}</label>
        `;
        groupsList.appendChild(div);
    });

    // Обработчик сохранения курса перенесён сюда, но если он уже есть ниже, ничего не меняйте
    document.getElementById('course-form')?.addEventListener('submit', (e) => {
        e.preventDefault();
        const title = document.getElementById('course-title').value;
        const courses = JSON.parse(localStorage.getItem('courses')) || [];

        // Выбранные преподаватели
        const teachers = Array.from(
            document.querySelectorAll('#teachers-list input:checked'),
            input => parseInt(input.value)
        );

        // Выбранные группы студентов
        const selGroups = Array.from(
            document.querySelectorAll('#student-groups-list input:checked'),
            input => input.value
        );

        courses.push({
            id: Date.now(),
            title,
            teachers,
            groups: selGroups
        });
        localStorage.setItem('courses', JSON.stringify(courses));
        loadContent('courses');
    });
};

// Инициализация страницы групп
const initGroupsPage = () => {
    document.getElementById('create-group-btn')?.addEventListener('click', () => {
        loadContent('group_creation');
    });

    const groupsContainer = document.getElementById('groups-container');
    groupsContainer.innerHTML = '';

    // Получаем группы из localStorage
    let groups = JSON.parse(localStorage.getItem('groups')) || [];
    
    // Проверяем, существует ли группа преподавателей
    let teachersGroup = groups.find(g => g.id === 'teachers');
    
    // Если группа преподавателей не найдена, создаем ее
    if (!teachersGroup) {
        teachersGroup = {
            id: 'teachers',
            name: 'Преподаватели',
            emails: []
        };
        groups.push(teachersGroup);
        localStorage.setItem('groups', JSON.stringify(groups));
    }

    // Добавляем группу преподавателей в интерфейс
    const teachersCard = document.createElement('div');
    teachersCard.className = 'group-card';
    teachersCard.innerHTML = `
        <div class="group-header">
            <div class="group-title">Преподаватели</div>
            <button class="btn btn-primary edit-group" data-id="teachers">Редактировать</button>
        </div>
        <div class="group-emails" id="teachers-emails"></div>
    `;
    groupsContainer.appendChild(teachersCard);

    // Заполняем список преподавателей
    const emails = JSON.parse(localStorage.getItem('emails')) || [];
    const teachersEmails = teachersCard.querySelector('.group-emails');
    
    teachersGroup.emails.forEach(emailId => {
        const email = emails.find(e => e.id == emailId);
        if (email) {
            const div = document.createElement('div');
            div.className = 'group-email-item';
            div.textContent = email.email;
            teachersEmails.appendChild(div);
        }
    });

    // Обработчик для группы преподавателей
    teachersCard.querySelector('.edit-group').addEventListener('click', () => {
        localStorage.setItem('currentGroup', 'teachers');
        loadContent('group_details');
    });

    // Заполняем список остальных групп
    groups.filter(g => g.id !== 'teachers').forEach(group => {
        const groupCard = document.createElement('div');
        groupCard.className = 'group-card';
        
        // Получаем список email для группы
        const groupEmails = group.emails.map(emailId => {
            const email = emails.find(e => e.id == emailId);
            return email ? email.email : '';
        }).filter(email => email);
        
        groupCard.innerHTML = `
            <div class="group-header">
                <div class="group-title">${group.name}</div>
                <button class="btn btn-primary edit-group" data-id="${group.id}">Редактировать</button>
            </div>
            <div class="group-emails">
                ${groupEmails.map(email => `
                    <div class="group-email-item">
                        <div>${email}</div>
                    </div>
                `).join('')}
            </div>
        `;
        
        groupCard.querySelector('.edit-group').addEventListener('click', () => {
            const groupId = groupCard.querySelector('.edit-group').dataset.id;
            localStorage.setItem('currentGroup', groupId);
            loadContent('group_details');
        });
        
        groupsContainer.appendChild(groupCard);
    });
};

// Инициализация страницы создания группы
const initGroupCreationPage = () => {
    // Заполняем список почт
    const emailsList = document.getElementById('group-emails-list');
    const emails = JSON.parse(localStorage.getItem('emails')) || [];
    
    emails.forEach(email => {
        const div = document.createElement('div');
        div.className = 'checkbox-item';
        div.innerHTML = `
            <input type="checkbox" id="group-email-${email.id}" value="${email.id}">
            <label for="group-email-${email.id}">${email.email}</label>
        `;
        emailsList.appendChild(div);
    });
    
    // Поиск почт
    document.getElementById('email-search')?.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        emailsList.querySelectorAll('.checkbox-item').forEach(item => {
            const label = item.querySelector('label').textContent.toLowerCase();
            item.style.display = label.includes(searchTerm) ? 'block' : 'none';
        });
    });
    
    // Отмена
    document.getElementById('cancel-group')?.addEventListener('click', () => {
        loadContent('groups');
    });
    
    // Сохранение группы
    document.getElementById('group-form')?.addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.getElementById('group-name').value;
        const groups = JSON.parse(localStorage.getItem('groups')) || [];
        
        // Собираем выбранные почты
        const emails = [];
        document.querySelectorAll('#group-emails-list input:checked').forEach(input => {
            emails.push(parseInt(input.value));
        });
        
        // Сохраняем новую группу
        groups.push({
            id: Date.now().toString(),
            name,
            emails
        });
        
        localStorage.setItem('groups', JSON.stringify(groups));
        loadContent('groups');
    });
};

// Инициализация страницы деталей группы
const initGroupDetailsPage = () => {
    const groupId = localStorage.getItem('currentGroup');
  const groups = JSON.parse(localStorage.getItem('groups')) || [];
  const group = groups.find(g => g.id == groupId);

if (!group) {
    loadContent('groups');
    return;
}

// Устанавливаем название группы
document.getElementById('group-title').textContent = `Группа: ${group.name}`;

// Заполняем список почт группы
const emailsContainer = document.getElementById('group-emails-container');
emailsContainer.innerHTML = '';

const allEmails = JSON.parse(localStorage.getItem('emails')) || [];
    group.emails.forEach(emailId => {
        const email = allEmails.find(e => e.id == emailId);
        if (email) {
            const div = document.createElement('div');
            div.className = 'list-item';
            div.innerHTML = `
                <div>${email.email}</div>
                <div class="list-item-actions">
                    <button class="btn btn-danger remove-email" data-id="${email.id}">Удалить</button>
                </div>
            `;
            emailsContainer.appendChild(div);
        }
    });

// Обработчик добавления почты
document.getElementById('add-email-btn')?.addEventListener('click', () => {
        const email = document.getElementById('add-email').value.trim();
        if (!email) return;

        // Для группы преподавателей: проверка роли
        if (groupId === 'teachers') {
            const emails = JSON.parse(localStorage.getItem('emails')) || [];
            const emailObj = emails.find(e => e.email === email);
            
            if (!emailObj || emailObj.role !== 'teacher') {
                alert('Этот email не является преподавателем. Сначала измените его роль в базе данных.');
                return;
            }
        }

    if (!emailExists) {
        // Добавляем новую почту
        const newEmail = {
            id: Date.now(),
            email,
            role: 'student'
        };
        emails.push(newEmail);
        localStorage.setItem('emails', JSON.stringify(emails));

        // Добавляем почту в группу
        group.emails.push(newEmail.id);
        localStorage.setItem('groups', JSON.stringify(groups));
        
        // Обновляем список
        initGroupDetailsPage();
    } else {
        alert('Этот email уже существует в базе');
    }
});

// Обработчики удаления почты
document.querySelectorAll('.remove-email').forEach(btn => {
    btn.addEventListener('click', () => {
        const emailId = btn.dataset.id;
        group.emails = group.emails.filter(id => id != emailId);
        localStorage.setItem('groups', JSON.stringify(groups));
        initGroupDetailsPage();
    });
});

// Обработчик удаления группы (не для преподавателей)
if (groupId !== 'teachers') {
        document.getElementById('delete-group')?.addEventListener('click', () => {
            const updatedGroups = groups.filter(g => g.id != groupId);
            localStorage.setItem('groups', JSON.stringify(updatedGroups));
            loadContent('groups');
        });
    } else {
        document.getElementById('delete-group').style.display = 'none';
    }
};

// Инициализация страницы базы данных
const initDatabasePage = () => {
    // Обработчик добавления почты
    document.getElementById('add-email-db')?.addEventListener('click', () => {
        loadContent('email_add');
    });

    // Заполняем список почт
    const dbContainer = document.getElementById('database-container');
    const emails = JSON.parse(localStorage.getItem('emails')) || [];
    dbContainer.innerHTML = '';

    emails.forEach(email => {
        const div = document.createElement('div');
        div.className = 'list-item';
        div.innerHTML = `
            <div>
                <div>${email.email}</div>
                <div class="text-tertiary">${email.role === 'teacher' ? 'Преподаватель' : 'Студент'}</div>
            </div>
            <div class="list-item-actions">
                <button class="btn btn-danger delete-email" data-id="${email.id}">Удалить</button>
            </div>
        `;
        dbContainer.appendChild(div);
    });

    // Обработчики удаления почты
    document.querySelectorAll('.delete-email').forEach(btn => {
        btn.addEventListener('click', () => {
            const emailId = btn.dataset.id;
            const emails = JSON.parse(localStorage.getItem('emails')) || [];
            const updatedEmails = emails.filter(e => e.id != emailId);
            localStorage.setItem('emails', JSON.stringify(updatedEmails));
            
            // Удаляем email из всех групп
            const groups = JSON.parse(localStorage.getItem('groups')) || [];
            groups.forEach(group => {
                group.emails = group.emails.filter(id => id != emailId);
            });
            localStorage.setItem('groups', JSON.stringify(groups));
            
            initDatabasePage();
        });
    });
};

// Инициализация страницы добавления почты
const initEmailAddPage = () => {
    // Отмена добавления
    document.getElementById('cancel-email')?.addEventListener('click', () => {
        loadContent('database');
    });

    // Сохранение почты
    document.getElementById('email-form')?.addEventListener('submit', (e) => {
        e.preventDefault();
        const email = document.getElementById('email-address').value;
        const role = document.getElementById('email-role').value;

        const emails = JSON.parse(localStorage.getItem('emails')) || [];
        emails.push({
            id: Date.now(),
            email,
            role
        });

        localStorage.setItem('emails', JSON.stringify(emails));
        
        // Если это преподаватель, добавляем в группу преподавателей
        if (role === 'teacher') {
            const groups = JSON.parse(localStorage.getItem('groups')) || [];
            const teachersGroup = groups.find(g => g.id === 'teachers');
            if (teachersGroup) {
                teachersGroup.emails.push(emails[emails.length - 1].id);
                localStorage.setItem('groups', JSON.stringify(groups));
            }
        }
        
        loadContent('database');
    });
};

const initUserCoursesPage = () => {
    const container = document.getElementById('user-courses-container');
    const userEmail = JSON.parse(localStorage.getItem('userProfile')).email;
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    const groups = JSON.parse(localStorage.getItem('groups')) || [];
    const emails = JSON.parse(localStorage.getItem('emails')) || [];

    // Находим ID пользователя по email
    const user = emails.find(e => e.email === userEmail);
    if (!user) {
        container.innerHTML = '<div class="empty-message">Курсы вам пока не доступны :(</div>';
        return;
    }

    // Фильтруем курсы, где пользователь является участником
    const userCourses = courses.filter(course => {
        // Проверяем преподавателей
        if (course.teachers?.includes(user.id)) return true;
        
        // Проверяем группы студентов
        if (course.groups) {
            for (const groupId of course.groups) {
                const group = groups.find(g => g.id == groupId);
                if (group && group.emails.includes(user.id)) return true;
            }
        }
        return false;
    });

    if (userCourses.length === 0) {
        container.innerHTML = '<div class="empty-message">Курсы вам пока не доступны :(</div>';
        return;
    }

    // Отображаем курсы пользователя
    userCourses.forEach(course => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div class="card__body">
                <h2 class="card__title">${course.title}</h2>
                <p class="card__progress">Ваша роль: ${course.teachers?.includes(user.id) ? 'Преподаватель' : 'Студент'}</p>
            </div>
        `;
        card.addEventListener('click', () => {
            localStorage.setItem('currentCourse', course.id);
            loadContent('course_detail');
        });
        container.appendChild(card);
    });
};

// Инициализация страницы деталей курса
const initCourseDetailPage = () => {
    const courseId = localStorage.getItem('currentCourse');
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    const course = courses.find(c => c.id == courseId);
    
    if (!course) {
        loadContent('user_courses');
        return;
    }
    
    // Определяем роль пользователя в курсе
    const userEmail = JSON.parse(localStorage.getItem('userProfile')).email;
    const emails = JSON.parse(localStorage.getItem('emails')) || [];
    const user = emails.find(e => e.email === userEmail);
    const isTeacher = course.teachers?.includes(user.id);
    
    // Настраиваем course bar
    const courseBar = document.getElementById('course-bar');
    courseBar.innerHTML = '';
    
    const tabs = [
        { id: 'course', text: 'Курс' },
        { id: 'settings', text: 'Настройки' },
        { id: 'stats', text: 'Статистика' }
    ];
    
    // Для студента убираем вкладку настроек
    if (!isTeacher) {
        tabs.splice(1, 1); // Удаляем вкладку настроек
        tabs[1].text = 'Успеваемость'; // Переименовываем статистику
    }
    
    tabs.forEach((tab, index) => {
        const btn = document.createElement('button');
        btn.className = 'course-bar-btn';
        if (index === (isTeacher ? 1 : 0)) btn.classList.add('active');
        btn.dataset.tab = tab.id;
        btn.textContent = tab.text;
        courseBar.appendChild(btn);
    });
    
    // Настраиваем сайдбар
    const courseSidebar = document.getElementById('course-sidebar');
    courseSidebar.innerHTML = '';
    
    // Добавляем кнопку "Назад"
    const backItem = document.createElement('div');
    backItem.className = 'course-sidebar-item';
    backItem.innerHTML = '&larr; Назад к курсам';
    backItem.addEventListener('click', () => loadContent('user_courses'));
    courseSidebar.appendChild(backItem);
    
    // Добавляем разделы в зависимости от вкладки
    const activeTab = document.querySelector('.course-bar-btn.active').dataset.tab;
    
    if (activeTab === 'settings') {
        const sections = [
            'О курсе', 'Описание', 'Изображение курса', 
            'Часы работы', 'Формат курса', 'Внешний вид', 'Группы'
        ];
        
        sections.forEach(section => {
            const item = document.createElement('div');
            item.className = 'course-sidebar-item';
            item.textContent = section;
            courseSidebar.appendChild(item);
        });
        
        // Загружаем контент настроек
        loadContent('course_settings');
        
    } else if (activeTab === 'course') {
        // Добавляем разделы для контента курса
        const sections = ['Общее', 'Тема 1', 'Тема 2', 'Тема 3'];
        
        sections.forEach(section => {
            const item = document.createElement('div');
            item.className = 'course-sidebar-item';
            item.textContent = section;
            courseSidebar.appendChild(item);
        });
        
        // Загружаем контент курса
        loadContent('course_content');
        
    } else {
        // Для статистики/успеваемости
        const item = document.createElement('div');
        item.className = 'course-sidebar-item active';
        item.textContent = 'Общая статистика';
        courseSidebar.appendChild(item);
        
        // Загружаем контент статистики
        const content = document.getElementById('course-content');
        content.innerHTML = '<h2>Статистика успеваемости</h2><p>Здесь будут отображаться статистические данные...</p>';
    }
    
    // Обработчики переключения вкладок
    document.querySelectorAll('.course-bar-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            document.querySelectorAll('.course-bar-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            initCourseDetailPage(); // Перезагружаем контент
        });
    });
};

// Инициализация страницы настроек курса
const initCourseSettings = () => {
    const courseId = localStorage.getItem('currentCourse');
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    const course = courses.find(c => c.id == courseId);
    
    if (!course) {
        loadContent('user_courses');
        return;
    }
    
    // Заполняем поля данными курса
    if (course.fullName) document.getElementById('course-full-name').value = course.fullName;
    if (course.shortName) document.getElementById('course-short-name').value = course.shortName;
    if (course.chatLink) document.getElementById('course-chat-link').value = course.chatLink;
    if (course.materialsLink) document.getElementById('course-materials-link').value = course.materialsLink;
    if (course.description) document.getElementById('course-description').innerHTML = course.description;
    if (course.image) document.getElementById('course-main-image').src = course.image;
    if (course.visibility) document.getElementById('course-visibility').value = course.visibility;
    if (course.allowDownload) document.getElementById('course-download').value = course.allowDownload;
    if (course.startDate) document.getElementById('course-start-date').value = course.startDate;
    if (course.courseId) document.getElementById('course-id').value = course.courseId;
    if (course.hiddenSections) document.getElementById('hidden-sections').value = course.hiddenSections;
    if (course.showGrades) document.getElementById('show-grades').value = course.showGrades;
    if (course.showReports) document.getElementById('show-reports').value = course.showReports;
    if (course.showDates) document.getElementById('show-dates').value = course.showDates;
    if (course.groupMode) document.getElementById('group-mode').value = course.groupMode;
    if (course.groupGrades) document.getElementById('group-grades').value = course.groupGrades;
    
    // Обработчик загрузки изображения
    document.getElementById('course-image-upload')?.addEventListener('click', () => {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'image/*';
        input.onchange = (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = document.createElement('img');
                    img.src = event.target.result;
                    img.alt = "Изображение курса";
                    document.getElementById('course-image-upload').innerHTML = '';
                    document.getElementById('course-image-upload').appendChild(img);
                    course.image = event.target.result;
                    localStorage.setItem('courses', JSON.stringify(courses));
                };
                reader.readAsDataURL(file);
            }
        };
        input.click();
    });
    
    // Обработчик добавления куратора
    document.getElementById('add-curator')?.addEventListener('click', () => {
        // В реальном приложении здесь должен быть список преподавателей курса
        alert('Функция добавления куратора в разработке');
    });
    
    // Обработчики сохранения данных при изменении
    const saveFields = [
        'course-full-name', 'course-short-name', 'course-chat-link', 'course-materials-link',
        'course-visibility', 'course-download', 'course-start-date', 'hidden-sections',
        'show-grades', 'show-reports', 'show-dates', 'group-mode', 'group-grades'
    ];
    
    saveFields.forEach(id => {
        document.getElementById(id)?.addEventListener('change', () => {
            course[id.replace('course-', '')] = document.getElementById(id).value;
            localStorage.setItem('courses', JSON.stringify(courses));
        });
    });
    
    // Сохранение описания
    document.getElementById('course-description')?.addEventListener('input', () => {
        course.description = document.getElementById('course-description').innerHTML;
        localStorage.setItem('courses', JSON.stringify(courses));
    });
};

// Инициализация страницы контента курса
const initCourseContent = () => {
    const courseId = localStorage.getItem('currentCourse');
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    const course = courses.find(c => c.id == courseId);
    
    if (!course) {
        loadContent('user_courses');
        return;
    }
    
    // Заполняем общую информацию
    document.getElementById('course-main-name').textContent = course.fullName || course.title;
    document.getElementById('course-main-description').innerHTML = course.description || '';
    if (course.image) {
        document.getElementById('course-main-image').src = course.image;
    }
    
    // Обработчик создания темы
    document.getElementById('create-theme')?.addEventListener('click', () => {
        if (!course.themes) course.themes = [];
        
        course.themes.push({
            id: Date.now(),
            title: 'Новая тема',
            description: '',
            assignments: []
        });
        
        localStorage.setItem('courses', JSON.stringify(courses));
        initCourseContent(); // Перезагружаем контент
    });
    
    // Отображаем темы
    const container = document.getElementById('themes-container');
    container.innerHTML = '';
    
    if (course.themes && course.themes.length > 0) {
        course.themes.forEach(theme => {
            const themeElement = document.createElement('div');
            themeElement.className = 'theme-card';
            themeElement.innerHTML = `
                <div class="theme-header">
                    <h3 class="theme-title">${theme.title}</h3>
                    <button class="btn btn-danger delete-theme">Удалить</button>
                </div>
                <div class="form-group">
                    <label>Название темы</label>
                    <input class="form-input theme-name" type="text" value="${theme.title}">
                </div>
                <div class="form-group">
                    <label>Описание темы</label>
                    <textarea class="form-input theme-description" rows="3">${theme.description}</textarea>
                </div>
                <div class="theme-content">
                    <h4>Задания и тесты</h4>
                    <button class="btn btn-secondary add-assignment">Добавить задание/тест</button>
                    <div class="assignments-container"></div>
                </div>
            `;
            
            // Обработчики для темы
            themeElement.querySelector('.theme-name').addEventListener('change', (e) => {
                theme.title = e.target.value;
                localStorage.setItem('courses', JSON.stringify(courses));
            });
            
            themeElement.querySelector('.theme-description').addEventListener('change', (e) => {
                theme.description = e.target.value;
                localStorage.setItem('courses', JSON.stringify(courses));
            });
            
            themeElement.querySelector('.delete-theme').addEventListener('click', () => {
                course.themes = course.themes.filter(t => t.id !== theme.id);
                localStorage.setItem('courses', JSON.stringify(courses));
                initCourseContent();
            });
            
            // Обработчик добавления задания
            themeElement.querySelector('.add-assignment').addEventListener('click', () => {
                if (!theme.assignments) theme.assignments = [];
                
                theme.assignments.push({
                    id: Date.now(),
                    title: 'Новое задание',
                    type: 'assignment',
                    description: '',
                    files: []
                });
                
                localStorage.setItem('courses', JSON.stringify(courses));
                initCourseContent();
            });
            
            // Отображаем задания
            const assignmentsContainer = themeElement.querySelector('.assignments-container');
            if (theme.assignments && theme.assignments.length > 0) {
                theme.assignments.forEach(assignment => {
                    const assignmentElement = document.createElement('div');
                    assignmentElement.className = 'assignment-item';
                    assignmentElement.innerHTML = `
                        <div class="assignment-header">
                            <div class="assignment-title">${assignment.title}</div>
                            <button class="btn btn-danger delete-assignment">Удалить</button>
                        </div>
                        <div class="form-group">
                            <label>Тип</label>
                            <div class="assignment-type">
                                <button class="type-btn ${assignment.type === 'assignment' ? 'active' : ''}" data-type="assignment">Задание</button>
                                <button class="type-btn ${assignment.type === 'quiz' ? 'active' : ''}" data-type="quiz">Тест</button>
                            </div>
                        </div>
                        <div class="assignment-content">
                            <div class="form-group">
                                <label>Название</label>
                                <input class="form-input assignment-title" type="text" value="${assignment.title}">
                            </div>
                            <div class="form-group">
                                <label>Описание</label>
                                <textarea class="form-input assignment-description" rows="2">${assignment.description || ''}</textarea>
                            </div>
                        </div>
                    `;
                    
                    // Обработчики для задания
                    assignmentElement.querySelector('.assignment-title').addEventListener('change', (e) => {
                        assignment.title = e.target.value;
                        localStorage.setItem('courses', JSON.stringify(courses));
                    });
                    
                    assignmentElement.querySelector('.assignment-description').addEventListener('change', (e) => {
                        assignment.description = e.target.value;
                        localStorage.setItem('courses', JSON.stringify(courses));
                    });
                    
                    assignmentElement.querySelector('.delete-assignment').addEventListener('click', () => {
                        theme.assignments = theme.assignments.filter(a => a.id !== assignment.id);
                        localStorage.setItem('courses', JSON.stringify(courses));
                        initCourseContent();
                    });
                    
                    // Обработчики изменения типа
                    assignmentElement.querySelectorAll('.type-btn').forEach(btn => {
                        btn.addEventListener('click', () => {
                            assignment.type = btn.dataset.type;
                            assignmentElement.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                            btn.classList.add('active');
                            localStorage.setItem('courses', JSON.stringify(courses));
                        });
                    });
                    
                    assignmentsContainer.appendChild(assignmentElement);
                });
            }
            
            container.appendChild(themeElement);
        });
    }
};

// Обновлённая инициализация страницы тестов и заданий (заменить существующую функцию)
const initQuizzesPage = () => {
    const container = document.getElementById('my-quizzes-container');
    const deadlineContainer = document.getElementById('deadline-container');
    const createBtn = document.getElementById('create-quiz-btn');
    const quizzes = JSON.parse(localStorage.getItem('quizzes')) || [];
    const userProfile = JSON.parse(localStorage.getItem('userProfile')) || {};
    const emails = JSON.parse(localStorage.getItem('emails')) || [];

    // Определяем роль текущего пользователя
    const user = emails.find(e => e.email === userProfile.email);
    const isTeacher = user && user.role === 'teacher';
    const isAdmin   = user && user.role === 'admin';

    // Показываем кнопку создания теста/задания для преподавателей и админов
    if (isTeacher || isAdmin) {
        createBtn.style.display = 'block';
        createBtn.addEventListener('click', () => loadContent('quiz_creation'));
    } else {
        createBtn.style.display = 'none';
    }

    // «Созданные мной»
    container.innerHTML = '';
    if (isTeacher || isAdmin) {
        quizzes
          .filter(q => q.creatorId === user.id)
          .forEach(quiz => {
              const card = document.createElement('div');
              card.className = 'card';
              card.innerHTML = `
                  <div class="card__body">
                      <h2 class="card__title">${quiz.title}</h2>
                      <p class="card__progress">${quiz.type === 'test' ? 'Тест' : 'Задание'}</p>
                  </div>
              `;
              card.addEventListener('click', () => {
                  localStorage.setItem('currentQuiz', quiz.id);
                  loadContent('quiz_creation');
              });
              container.appendChild(card);
          });
    } else {
        container.innerHTML = '<div class="empty-message">Здесь нет созданных вами тестов или заданий.</div>';
    }

    // «Дедлайны» для студентов
    deadlineContainer.innerHTML = '';
    const studentQuizzes = quizzes
      .filter(q => q.participants?.includes(user.id))
      .sort((a, b) => new Date(a.deadline) - new Date(b.deadline));

    studentQuizzes.forEach(q => {
        const item = document.createElement('div');
        item.className = 'deadline-item ' + (q.type === 'assignment' ? 'deadline-assignment' : 'deadline-quiz');
        item.innerHTML = `
            <span>${q.courseTitle} / ${q.title} : ${new Date(q.deadline).toLocaleString()}</span>
            <button type="button" class="btn btn-secondary">К тесту/заданию →</button>
        `;
        item.querySelector('button').addEventListener('click', () => {
            localStorage.setItem('currentQuiz', q.id);
            loadContent('student_quiz_start');
        });
        deadlineContainer.appendChild(item);
    });
};

// Инициализация страницы успеваемости
const initPerformancePage = () => {
    const tbody = document.getElementById('performance-table-body');
    const userEmail = JSON.parse(localStorage.getItem('userProfile')).email;
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    const groups = JSON.parse(localStorage.getItem('groups')) || [];
    const emails = JSON.parse(localStorage.getItem('emails')) || [];

    // Находим ID пользователя по email
    const user = emails.find(e => e.email === userEmail);
    if (!user) {
        tbody.innerHTML = '<tr><td colspan="2">Вы не зарегистрированы в системе</td></tr>';
        return;
    }

    // Фильтруем курсы, где пользователь является студентом
    const studentCourses = courses.filter(course => {
        if (!course.groups) return false;
        for (const groupId of course.groups) {
            const group = groups.find(g => g.id == groupId);
            if (group && group.emails.includes(user.id)) return true;
        }
        return false;
    });

    if (studentCourses.length === 0) {
        tbody.innerHTML = '<tr><td colspan="2">Вы не является студентом ни в одном из доступных курсов :(</td></tr>';
        return;
    }

    // Отображаем курсы и оценки
    studentCourses.forEach(course => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${course.title}</td>
            <td>${course.grades?.[user.id] || 'Нет оценки'}</td>
        `;
        tbody.appendChild(row);
    });
};

// Инициализация страницы профиля
const initProfilePage = () => {
    const profile = JSON.parse(localStorage.getItem('userProfile')) || {};
    
    // Заполняем поля профиля
    if (profile.name) document.getElementById('profile-name').value = profile.name;
    if (profile.email) document.getElementById('profile-email').value = profile.email;
    
    document.querySelectorAll('.role-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const newRole = btn.dataset.role;
        localStorage.setItem('role', newRole);
        updateRoleVisibility();  // ← обновляем
        loadContent('dashboard');
    });
});

    
    // Сохранение изменений профиля
    document.getElementById('profile-name').addEventListener('change', e => {
        profile.name = e.target.value;
        localStorage.setItem('userProfile', JSON.stringify(profile));
    });

    document.getElementById('profile-email').addEventListener('change', e => {
        profile.email = e.target.value;
        localStorage.setItem('userProfile', JSON.stringify(profile));
    });
};

// Навигация по разделам
const setupNavigation = () => {
    document.querySelectorAll('.sidebar__nav a').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const section = link.dataset.section;
            loadContent(section);
        });
    });

    // Кнопка "Назад"
    document.getElementById('back-link')?.addEventListener('click', (e) => {
        e.preventDefault();
        loadContent('dashboard');
    });
};

// Инициализация приложения
document.addEventListener('DOMContentLoaded', () => {
    initData();
    initTheme();
    setupThemeToggle();
    updateRoleVisibility();
    setupNavigation();

    // Загружаем последний открытый раздел
    const currentSection = localStorage.getItem('currentSection') || 'dashboard';
    loadContent(currentSection);

    // Обработчик выхода
    document.getElementById('logout-link')?.addEventListener('click', (e) => {
        e.preventDefault();
        window.location.href = 'login.html';
    });
});

const initQuizCreationPage = () => {
    const modal = document.querySelector('.modal');
    const closeBtn = modal.querySelector('.modal-close');
    
    // Закрытие модального окна
    closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
        loadContent('quizzes');
    });
    
    // Заполнение выбора курсов
    const courseSelect = document.getElementById('quiz-course');
    const courses = JSON.parse(localStorage.getItem('courses')) || [];
    
    courses.forEach(course => {
        const option = document.createElement('option');
        option.value = course.id;
        option.textContent = course.title;
        courseSelect.appendChild(option);
    });
    
    // Обработчик изменения типа задания/теста
    const quizTypeSelect = document.getElementById('quiz-type');
    const quizContent = document.getElementById('quiz-content');
    
    quizTypeSelect.addEventListener('change', () => {
        quizContent.innerHTML = '';
        
        if (quizTypeSelect.value === 'test') {
            const testTemplate = document.getElementById('test-content-template');
            quizContent.appendChild(testTemplate.content.cloneNode(true));
            initTestContent();
        } else {
            const assignmentTemplate = document.getElementById('assignment-content-template');
            quizContent.appendChild(assignmentTemplate.content.cloneNode(true));
            initAssignmentContent();
        }
    });
    
    // Инициализация контента по умолчанию
    quizTypeSelect.dispatchEvent(new Event('change'));
    
    // Обработчик добавления вопроса
    document.getElementById('add-question')?.addEventListener('click', () => {
        addQuestion();
    });
    
    // Обработчик отправки формы
    const quizForm = document.getElementById('quiz-form');
    quizForm.addEventListener('submit', (e) => {
        e.preventDefault();
        saveQuiz();
    });
    
    // Обработчик отмены
    document.getElementById('cancel-quiz')?.addEventListener('click', () => {
        modal.style.display = 'none';
        loadContent('quizzes');
    });
    
    // Загрузка существующего теста/задания для редактирования
    const quizId = localStorage.getItem('currentQuiz');
    if (quizId) {
        const quizzes = JSON.parse(localStorage.getItem('quizzes')) || [];
        const quiz = quizzes.find(q => q.id == quizId);
        
        if (quiz) {
            // Заполняем форму данными
            document.getElementById('quiz-title').value = quiz.title;
            document.getElementById('quiz-description').value = quiz.description || '';
            document.getElementById('quiz-type').value = quiz.type;
            document.getElementById('quiz-start').value = quiz.start;
            document.getElementById('quiz-end').value = quiz.end;
            document.getElementById('quiz-course').value = quiz.courseId;
            
            // Обновляем контент в соответствии с типом
            quizTypeSelect.dispatchEvent(new Event('change'));
            
            // Заполняем контент
            if (quiz.type === 'test' && quiz.questions) {
                quiz.questions.forEach(q => {
                    const question = addQuestion();
                    question.querySelector('.question-text').value = q.text;
                    
                    // Заполняем варианты ответов
                    const optionsList = question.querySelector('.options-list');
                    q.options.forEach((opt, i) => {
                        const option = addOption(optionsList);
                        option.querySelector('.option-text').value = opt.text;
                        
                        if (q.type === 'choice') {
                            option.querySelector('.option-correct').checked = opt.correct;
                        }
                    });
                    
                    // Устанавливаем тип вопроса
                    question.querySelector('.question-type').value = q.type;
                });
            } else if (quiz.files) {
                const fileList = document.getElementById('file-list');
                quiz.files.forEach(file => {
                    addFileItem(fileList, file.name);
                });
            }
        }
    }
    
    // Автосохранение каждые 30 секунд
    setInterval(saveDraft, 30000);
};

// Добавление нового вопроса
const addQuestion = () => {
    const questionsContainer = document.getElementById('questions-container');
    const questionTemplate = document.getElementById('question-template');
    const questionElement = questionTemplate.content.cloneNode(true);
    
    // Обработчик изменения типа вопроса
    const questionType = questionElement.querySelector('.question-type');
    questionType.addEventListener('change', () => {
        const optionsContainer = questionElement.querySelector('.question-options');
        optionsContainer.style.display = questionType.value === 'choice' ? 'block' : 'none';
    });
    
    // Обработчик добавления варианта ответа
    const addOptionBtn = questionElement.querySelector('.add-option');
    addOptionBtn.addEventListener('click', () => {
        const optionsList = questionElement.querySelector('.options-list');
        addOption(optionsList);
    });
    
    // Обработчик удаления вопроса
    const deleteBtn = questionElement.querySelector('.delete-question');
    deleteBtn.addEventListener('click', () => {
        questionsContainer.removeChild(questionElement);
    });
    
    questionsContainer.appendChild(questionElement);
    return questionElement;
};

// Добавление варианта ответа
const addOption = (container) => {
    const optionTemplate = document.createElement('div');
    optionTemplate.className = 'option';
    optionTemplate.innerHTML = `
        <input type="${container.closest('.question-editor') ? 'checkbox' : 'radio'}" 
               class="option-correct" name="correct-option">
        <input type="text" class="option-text form-input" placeholder="Вариант ответа">
        <button type="button" class="btn btn-danger delete-option">×</button>
    `;
    
    // Обработчик удаления варианта
    optionTemplate.querySelector('.delete-option').addEventListener('click', () => {
        container.removeChild(optionTemplate);
    });
    
    container.appendChild(optionTemplate);
    return optionTemplate;
};

// Инициализация контента для теста
const initTestContent = () => {
    // Добавляем первый вопрос
    document.getElementById('add-question')?.click();
};

// Инициализация контента для задания
const initAssignmentContent = () => {
    const fileUpload = document.getElementById('file-upload-area');
    const fileInput = document.getElementById('assignment-files');
    const fileList = document.getElementById('file-list');
    
    // Обработчик клика по области загрузки
    fileUpload.addEventListener('click', () => {
        fileInput.click();
    });
    
    // Обработчик изменения файлов
    fileInput.addEventListener('change', () => {
        for (const file of fileInput.files) {
            addFileItem(fileList, file.name);
        }
    });
    
    // Обработчик перетаскивания файлов
    fileUpload.addEventListener('dragover', (e) => {
        e.preventDefault();
        fileUpload.classList.add('dragover');
    });
    
    fileUpload.addEventListener('dragleave', () => {
        fileUpload.classList.remove('dragover');
    });
    
    fileUpload.addEventListener('drop', (e) => {
        e.preventDefault();
        fileUpload.classList.remove('dragover');
        
        for (const file of e.dataTransfer.files) {
            addFileItem(fileList, file.name);
        }
    });
};

// Добавление элемента файла
const addFileItem = (container, fileName) => {
    const fileItem = document.createElement('div');
    fileItem.className = 'file-item';
    fileItem.innerHTML = `
        <div>${fileName}</div>
        <button class="btn btn-danger delete-file">×</button>
    `;
    
    // Обработчик удаления файла
    fileItem.querySelector('.delete-file').addEventListener('click', () => {
        container.removeChild(fileItem);
    });
    
    container.appendChild(fileItem);
};

// Сохранение черновика
const saveDraft = () => {
    const quizData = getQuizFormData();
    localStorage.setItem('draftQuiz', JSON.stringify(quizData));
};

// Получение данных формы
const getQuizFormData = () => {
    const questions = [];
    document.querySelectorAll('.question-editor').forEach(question => {
        const text = question.querySelector('.question-text').value;
        const type = question.querySelector('.question-type').value;
        const options = [];
        
        if (type === 'choice') {
            question.querySelectorAll('.option').forEach(option => {
                const text = option.querySelector('.option-text').value;
                const correct = option.querySelector('.option-correct').checked;
                options.push({ text, correct });
            });
        }
        
        questions.push({ text, type, options });
    });
    
    const files = [];
    document.querySelectorAll('#file-list .file-item').forEach(file => {
        files.push(file.querySelector('div').textContent);
    });
    
    return {
        title: document.getElementById('quiz-title').value,
        description: document.getElementById('quiz-description').value,
        type: document.getElementById('quiz-type').value,
        courseId: document.getElementById('quiz-course').value,
        start: document.getElementById('quiz-start').value,
        end: document.getElementById('quiz-end').value,
        questions,
        files
    };
};

// Сохранение теста/задания
const saveQuiz = () => {
    const quizData = getQuizFormData();
    const quizzes = JSON.parse(localStorage.getItem('quizzes')) || [];
    const quizId = localStorage.getItem('currentQuiz');
    
    if (quizId) {
        // Редактирование существующего
        const index = quizzes.findIndex(q => q.id == quizId);
        if (index !== -1) {
            quizzes[index] = { ...quizzes[index], ...quizData };
        }
    } else {
        // Создание нового
        const userEmail = JSON.parse(localStorage.getItem('userProfile')).email;
        const emails = JSON.parse(localStorage.getItem('emails')) || [];
        const user = emails.find(e => e.email === userEmail);
        
        quizzes.push({
            id: Date.now(),
            ...quizData,
            creatorId: user.id
        });
    }
    
    localStorage.setItem('quizzes', JSON.stringify(quizzes));
    localStorage.removeItem('draftQuiz');
    
    // Закрываем модальное окно
    document.querySelector('.modal').style.display = 'none';
    loadContent('quizzes');
};

</script>

<!-- ====== ДОБАВЛЕНО: Шаблоны ====== -->

<template id="group-creation-template">
  <div class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Создать группу</h2>
        <button class="modal-close" onclick="document.querySelector('.modal').remove()">&times;</button>
      </div>
      <form id="group-creation-form">
        <div class="form-group">
          <label>Название группы</label>
          <input type="text" id="new-group-name" class="form-input" placeholder="CSE-05" required>
        </div>
        <div class="form-group">
          <label>Поиск пользователей</label>
          <input type="text" id="group-user-search" class="form-input" placeholder="Введите email">
        </div>
        <div class="form-group">
          <label>Участники</label>
          <div id="group-user-list" class="options-list"></div>
        </div>
        <div class="form-actions">
          <button type="button" id="cancel-group" class="btn btn-secondary">Отмена</button>
          <button type="submit" class="btn btn-primary">Сохранить</button>
        </div>
      </form>
    </div>
  </div>
</template>

<template id="database-template">
  <div class="page database">
    <h2>База данных пользователей</h2>
    <form id="add-email-form">
      <input type="email" id="new-email" placeholder="example@site.com" required />
      <select id="new-role">
        <option value="student">Студент</option>
        <option value="teacher">Преподаватель</option>
      </select>
      <button type="submit">Добавить</button>
    </form>
    <ul id="email-list"></ul>
  </div>
</template>

<template id="course-creation-template">
  <div class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Создать курс</h2>
        <button class="modal-close" onclick="document.querySelector('.modal').remove()">&times;</button>
      </div>
      <form id="course-creation-form">
        <div class="form-group">
          <label>Название курса</label>
          <input type="text" id="new-course-name" class="form-input" required>
        </div>
        <div class="form-group">
          <label>Добавить участников из</label>
          <select id="course-group-select" class="form-input">
            <option value="teachers">Преподаватели</option>
          </select>
        </div>
        <div class="form-group">
          <label>Участники</label>
          <div id="course-user-list" class="options-list"></div>
        </div>
        <div class="form-actions">
          <button type="button" id="cancel-course" class="btn btn-secondary">Отмена</button>
          <button type="submit" class="btn btn-primary">Сохранить</button>
        </div>
      </form>
    </div>
  </div>
</template>

<template id="course-editing-template">
  <div class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Редактировать курс</h2>
        <button class="modal-close" onclick="document.querySelector('.modal').remove()">&times;</button>
      </div>
      <form id="course-editing-form">
        <div class="form-group">
          <label>Название курса</label>
          <input type="text" id="edit-course-name" class="form-input" required>
        </div>
        <div class="form-group">
          <label>Преподаватели курса</label>
          <div id="teachersList" class="options-list"></div>
        </div>
        <div class="form-group">
          <label>Группы в курсе</label>
          <div id="courseGroupsList" class="options-list"></div>
        </div>
        <div class="form-actions">
          <button type="button" id="delete-course" class="btn btn-danger">Удалить курс</button>
          <button type="submit" class="btn btn-primary">Сохранить курс</button>
        </div>
      </form>
    </div>
  </div>
</template>

<!-- ====== ДОБАВЛЕНО: Скрипты ====== -->
<script>
const initDatabasePage = () => {
  const list = document.getElementById('email-list');
  const form = document.getElementById('add-email-form');
  const emails = JSON.parse(localStorage.getItem('emails') || '[]');
  const render = () => {
    list.innerHTML = '';
    emails.forEach((e,i) => {
      const li = document.createElement('li');
      li.innerHTML = \`\${e.email} — \${e.role}
        <button onclick="removeEmail(\${i})">Удалить</button>
        <button onclick="toggleRole(\${i})">Сменить роль</button>\`;
      list.appendChild(li);
    });
  };
  window.removeEmail = i => { emails.splice(i,1); localStorage.setItem('emails',JSON.stringify(emails)); render(); };
  window.toggleRole = i => { emails[i].role = emails[i].role==='student'?'teacher':'student'; localStorage.setItem('emails',JSON.stringify(emails)); render(); };
  form.onsubmit = e => {
    e.preventDefault();
    const email = document.getElementById('new-email').value;
    const role = document.getElementById('new-role').value;
    if(!emails.some(x=>x.email===email)) {
      emails.push({ email, role, id:Date.now().toString() });
      localStorage.setItem('emails',JSON.stringify(emails));
    }
    form.reset();
    render();
  };
  render();
};

const initCourseEditing = () => {
  const form = document.getElementById('course-editing-form');
  const teachersList = document.getElementById('teachersList');
  const groupsList = document.getElementById('courseGroupsList');
  const emails = JSON.parse(localStorage.getItem('emails')||'[]');
  const courses = JSON.parse(localStorage.getItem('courses')||'[]');
  const currentId = localStorage.getItem('currentCourse');
  const course = courses.find(c=>c.id===currentId);
  // preload name
  document.getElementById('edit-course-name').value = course.title;
  // populate teachers checkboxes
  teachersList.innerHTML = '';
  emails.filter(e=>e.role==='teacher').forEach(t=>{
    const lbl = document.createElement('label');
    lbl.innerHTML = \`<input type="checkbox" value="\${t.id}" \${course.teachers.includes(t.id)?'checked':''}> \${t.email}\`;
    teachersList.appendChild(lbl);
  });
  // populate groups list
  groupsList.innerHTML = '';
  (JSON.parse(localStorage.getItem('groups'))||[]).forEach(g=>{
    const lbl = document.createElement('label');
    lbl.innerHTML = \`<input type="checkbox" value="\${g.id}" \${course.groups.includes(g.id)?'checked':''}> \${g.name}\`;
    groupsList.appendChild(lbl);
  });
  // delete course
  document.getElementById('delete-course').onclick = () => {
    const idx = courses.findIndex(c=>c.id===currentId);
    courses.splice(idx,1);
    localStorage.setItem('courses',JSON.stringify(courses));
    document.querySelector('.modal').remove();
    loadContent('courses');
  };
  // save course
  form.onsubmit = e => {
    e.preventDefault();
    course.title = document.getElementById('edit-course-name').value;
    course.teachers = Array.from(teachersList.querySelectorAll('input:checked')).map(i=>i.value);
    course.groups = Array.from(groupsList.querySelectorAll('input:checked')).map(i=>i.value);
    localStorage.setItem('courses',JSON.stringify(courses));
    document.querySelector('.modal').remove();
    loadContent('courses');
  };
};

const loadContent = section => {
  const main = document.getElementById('main-content');
  const map = {
    'database':'database-template',
    'group_creation':'group-creation-template',
    'course_creation':'course-creation-template',
    'course_editing':'course-editing-template'
  };
  const tpl = map[section];
  if(!tpl) return;
  const template = document.getElementById(tpl);
  main.innerHTML = '';
  main.appendChild(template.content.cloneNode(true));
  if(section==='database') initDatabasePage();
  if(section==='course_editing') initCourseEditing();
};

</script>

</body>
</html>

